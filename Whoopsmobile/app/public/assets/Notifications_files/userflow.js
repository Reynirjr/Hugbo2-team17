const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["ResourceCenterApp.v1.DxGbj0O9.js","index.v1.BnpjMr1p.js","typeof.v1.DCF4SmM_.js","flow-host.styl.v1.dnY0B0fU.js","TreeDoc.v1.BZRxtGCu.js","flow-condition-types.v1.DSgTaawO.js","roots.v1.CI09eEUl.js","stylesheets.v1.BQoIq-UK.js","iframe-reset.styl.v1.SRpkcxOO.js","unsupportedIterableToArray.v1.Bh-jFtrU.js","use-selector-element-monitoring.v1.BUL0VMxF.js","Frame.v1.CrMj35VE.js","use-window-resize.v1.DLY5k2rF.js","logomark.v1.BEculxj9.js","ChecklistUI.v1.CGq16p0K.js","FlowChrome.v1.CWhxe_uv.js","use-client-query.v1.BkbMJ-u_.js","memoize-one.esm.v1.D9hj0mbK.js","use-element-rect.v1.ka5I9x3x.js","BannerApp.v1.C4IpNGe9.js","SitePage.v1.DgluTuf_.js","Popover.v1.CWNBPRF-.js","react-hooks.v1.Chq34_06.js","lodash.v1.pSe8OIzF.js","implicit-tracking.v1.CfyhJvnx.js","DebuggerUI.v1.cbZqZZGf.js","ui.v1.BixPdj8k.js"])))=>i.map(i=>d[i]);
(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="25e06691-0814-4cdf-8247-9dea3f461b04",e._sentryDebugIdIdentifier="sentry-dbid-25e06691-0814-4cdf-8247-9dea3f461b04")}catch{}})();var zr=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};zr.SENTRY_RELEASE={id:"803d9a7a3d6d45698444dfb3a233e51e17968e60"};var X=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ll(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var j=function(e){return e&&e.Math===Math&&e},T=j(typeof globalThis=="object"&&globalThis)||j(typeof window=="object"&&window)||j(typeof self=="object"&&self)||j(typeof X=="object"&&X)||j(typeof X=="object"&&X)||function(){return this}()||Function("return this")(),Xe={},N=function(e){try{return!!e()}catch{return!0}},Yr=N,U=!Yr(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Jr=N,Qe=!Jr(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),Xr=Qe,Q=Function.prototype.call,L=Xr?Q.bind(Q):function(){return Q.apply(Q,arguments)},Zt={},qt={}.propertyIsEnumerable,er=Object.getOwnPropertyDescriptor,Qr=er&&!qt.call({1:2},1);Zt.f=Qr?function(t){var r=er(this,t);return!!r&&r.enumerable}:qt;var tr=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},rr=Qe,sr=Function.prototype,xe=sr.call,Zr=rr&&sr.bind.bind(xe,xe),R=rr?Zr:function(e){return function(){return xe.apply(e,arguments)}},ir=R,qr=ir({}.toString),es=ir("".slice),Te=function(e){return es(qr(e),8,-1)},ts=R,rs=N,ss=Te,me=Object,is=ts("".split),ns=rs(function(){return!me("z").propertyIsEnumerable(0)})?function(e){return ss(e)==="String"?is(e,""):me(e)}:me,Ze=function(e){return e==null},os=Ze,as=TypeError,nr=function(e){if(os(e))throw new as("Can't call method on "+e);return e},cs=ns,ls=nr,qe=function(e){return cs(ls(e))},we=typeof document=="object"&&document.all,w=typeof we>"u"&&we!==void 0?function(e){return typeof e=="function"||e===we}:function(e){return typeof e=="function"},us=w,W=function(e){return typeof e=="object"?e!==null:us(e)},Ie=T,hs=w,ds=function(e){return hs(e)?e:void 0},or=function(e,t){return arguments.length<2?ds(Ie[e]):Ie[e]&&Ie[e][t]},fs=R,ar=fs({}.isPrototypeOf),Es=T,ht=Es.navigator,dt=ht&&ht.userAgent,cr=dt?String(dt):"",lr=T,Ce=cr,ft=lr.process,Et=lr.Deno,vt=ft&&ft.versions||Et&&Et.version,gt=vt&&vt.v8,I,fe;gt&&(I=gt.split("."),fe=I[0]>0&&I[0]<4?1:+(I[0]+I[1]));!fe&&Ce&&(I=Ce.match(/Edge\/(\d+)/),(!I||I[1]>=74)&&(I=Ce.match(/Chrome\/(\d+)/),I&&(fe=+I[1])));var ur=fe,St=ur,vs=N,gs=T,Ss=gs.String,hr=!!Object.getOwnPropertySymbols&&!vs(function(){var e=Symbol("symbol detection");return!Ss(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&St&&St<41}),Ts=hr,dr=Ts&&!Symbol.sham&&typeof Symbol.iterator=="symbol",ps=or,ms=w,ws=ar,Is=dr,Cs=Object,fr=Is?function(e){return typeof e=="symbol"}:function(e){var t=ps("Symbol");return ms(t)&&ws(t.prototype,Cs(e))},ys=String,et=function(e){try{return ys(e)}catch{return"Object"}},bs=w,Rs=et,Os=TypeError,z=function(e){if(bs(e))return e;throw new Os(Rs(e)+" is not a function")},ks=z,_s=Ze,tt=function(e,t){var r=e[t];return _s(r)?void 0:ks(r)},ye=L,be=w,Re=W,Ns=TypeError,Us=function(e,t){var r,s;if(t==="string"&&be(r=e.toString)&&!Re(s=ye(r,e))||be(r=e.valueOf)&&!Re(s=ye(r,e))||t!=="string"&&be(r=e.toString)&&!Re(s=ye(r,e)))return s;throw new Ns("Can't convert object to primitive value")},Er={exports:{}},Tt=T,Ls=Object.defineProperty,rt=function(e,t){try{Ls(Tt,e,{value:t,configurable:!0,writable:!0})}catch{Tt[e]=t}return t},As=T,$s=rt,pt="__core-js_shared__",mt=Er.exports=As[pt]||$s(pt,{});(mt.versions||(mt.versions=[])).push({version:"3.39.0",mode:"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"});var st=Er.exports,wt=st,vr=function(e,t){return wt[e]||(wt[e]=t||{})},Ds=nr,Ps=Object,Ms=function(e){return Ps(Ds(e))},js=R,Bs=Ms,xs=js({}.hasOwnProperty),A=Object.hasOwn||function(t,r){return xs(Bs(t),r)},Hs=R,Gs=0,Fs=Math.random(),Ks=Hs(1 .toString),gr=function(e){return"Symbol("+(e===void 0?"":e)+")_"+Ks(++Gs+Fs,36)},Vs=T,Ws=vr,It=A,zs=gr,Ys=hr,Js=dr,M=Vs.Symbol,Oe=Ws("wks"),Xs=Js?M.for||M:M&&M.withoutSetter||zs,$=function(e){return It(Oe,e)||(Oe[e]=Ys&&It(M,e)?M[e]:Xs("Symbol."+e)),Oe[e]},Qs=L,Ct=W,yt=fr,Zs=tt,qs=Us,ei=$,ti=TypeError,ri=ei("toPrimitive"),si=function(e,t){if(!Ct(e)||yt(e))return e;var r=Zs(e,ri),s;if(r){if(t===void 0&&(t="default"),s=Qs(r,e,t),!Ct(s)||yt(s))return s;throw new ti("Can't convert object to primitive value")}return t===void 0&&(t="number"),qs(e,t)},ii=si,ni=fr,Sr=function(e){var t=ii(e,"string");return ni(t)?t:t+""},oi=T,bt=W,He=oi.document,ai=bt(He)&&bt(He.createElement),ci=function(e){return ai?He.createElement(e):{}},li=U,ui=N,hi=ci,Tr=!li&&!ui(function(){return Object.defineProperty(hi("div"),"a",{get:function(){return 7}}).a!==7}),di=U,fi=L,Ei=Zt,vi=tr,gi=qe,Si=Sr,Ti=A,pi=Tr,Rt=Object.getOwnPropertyDescriptor;Xe.f=di?Rt:function(t,r){if(t=gi(t),r=Si(r),pi)try{return Rt(t,r)}catch{}if(Ti(t,r))return vi(!fi(Ei.f,t,r),t[r])};var pe={},mi=U,wi=N,Ii=mi&&wi(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Ci=W,yi=String,bi=TypeError,Y=function(e){if(Ci(e))return e;throw new bi(yi(e)+" is not an object")},Ri=U,Oi=Tr,ki=Ii,Z=Y,Ot=Sr,_i=TypeError,ke=Object.defineProperty,Ni=Object.getOwnPropertyDescriptor,_e="enumerable",Ne="configurable",Ue="writable";pe.f=Ri?ki?function(t,r,s){if(Z(t),r=Ot(r),Z(s),typeof t=="function"&&r==="prototype"&&"value"in s&&Ue in s&&!s[Ue]){var i=Ni(t,r);i&&i[Ue]&&(t[r]=s.value,s={configurable:Ne in s?s[Ne]:i[Ne],enumerable:_e in s?s[_e]:i[_e],writable:!1})}return ke(t,r,s)}:ke:function(t,r,s){if(Z(t),r=Ot(r),Z(s),Oi)try{return ke(t,r,s)}catch{}if("get"in s||"set"in s)throw new _i("Accessors not supported");return"value"in s&&(t[r]=s.value),t};var Ui=U,Li=pe,Ai=tr,pr=Ui?function(e,t,r){return Li.f(e,t,Ai(1,r))}:function(e,t,r){return e[t]=r,e},mr={exports:{}},Ge=U,$i=A,wr=Function.prototype,Di=Ge&&Object.getOwnPropertyDescriptor,it=$i(wr,"name"),Pi=it&&function(){}.name==="something",Mi=it&&(!Ge||Ge&&Di(wr,"name").configurable),ji={EXISTS:it,PROPER:Pi,CONFIGURABLE:Mi},Bi=R,xi=w,Fe=st,Hi=Bi(Function.toString);xi(Fe.inspectSource)||(Fe.inspectSource=function(e){return Hi(e)});var Ir=Fe.inspectSource,Gi=T,Fi=w,kt=Gi.WeakMap,Ki=Fi(kt)&&/native code/.test(String(kt)),Vi=vr,Wi=gr,_t=Vi("keys"),zi=function(e){return _t[e]||(_t[e]=Wi(e))},Cr={},Yi=Ki,yr=T,Ji=W,Xi=pr,Le=A,Ae=st,Qi=zi,Zi=Cr,Nt="Object already initialized",Ke=yr.TypeError,qi=yr.WeakMap,Ee,V,ve,en=function(e){return ve(e)?V(e):Ee(e,{})},tn=function(e){return function(t){var r;if(!Ji(t)||(r=V(t)).type!==e)throw new Ke("Incompatible receiver, "+e+" required");return r}};if(Yi||Ae.state){var C=Ae.state||(Ae.state=new qi);C.get=C.get,C.has=C.has,C.set=C.set,Ee=function(e,t){if(C.has(e))throw new Ke(Nt);return t.facade=e,C.set(e,t),t},V=function(e){return C.get(e)||{}},ve=function(e){return C.has(e)}}else{var P=Qi("state");Zi[P]=!0,Ee=function(e,t){if(Le(e,P))throw new Ke(Nt);return t.facade=e,Xi(e,P,t),t},V=function(e){return Le(e,P)?e[P]:{}},ve=function(e){return Le(e,P)}}var rn={set:Ee,get:V,has:ve,enforce:en,getterFor:tn},nt=R,sn=N,nn=w,q=A,Ve=U,on=ji.CONFIGURABLE,an=Ir,br=rn,cn=br.enforce,ln=br.get,Ut=String,ae=Object.defineProperty,un=nt("".slice),hn=nt("".replace),dn=nt([].join),fn=Ve&&!sn(function(){return ae(function(){},"length",{value:8}).length!==8}),En=String(String).split("String"),vn=mr.exports=function(e,t,r){un(Ut(t),0,7)==="Symbol("&&(t="["+hn(Ut(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!q(e,"name")||on&&e.name!==t)&&(Ve?ae(e,"name",{value:t,configurable:!0}):e.name=t),fn&&r&&q(r,"arity")&&e.length!==r.arity&&ae(e,"length",{value:r.arity});try{r&&q(r,"constructor")&&r.constructor?Ve&&ae(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var s=cn(e);return q(s,"source")||(s.source=dn(En,typeof t=="string"?t:"")),e};Function.prototype.toString=vn(function(){return nn(this)&&ln(this).source||an(this)},"toString");var gn=mr.exports,Sn=w,Tn=pe,pn=gn,mn=rt,wn=function(e,t,r,s){s||(s={});var i=s.enumerable,n=s.name!==void 0?s.name:t;if(Sn(r)&&pn(r,n,s),s.global)i?e[t]=r:mn(t,r);else{try{s.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:Tn.f(e,t,{value:r,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return e},Rr={},In=Math.ceil,Cn=Math.floor,yn=Math.trunc||function(t){var r=+t;return(r>0?Cn:In)(r)},bn=yn,Or=function(e){var t=+e;return t!==t||t===0?0:bn(t)},Rn=Or,On=Math.max,kn=Math.min,_n=function(e,t){var r=Rn(e);return r<0?On(r+t,0):kn(r,t)},Nn=Or,Un=Math.min,Ln=function(e){var t=Nn(e);return t>0?Un(t,9007199254740991):0},An=Ln,kr=function(e){return An(e.length)},$n=qe,Dn=_n,Pn=kr,Lt=function(e){return function(t,r,s){var i=$n(t),n=Pn(i);if(n===0)return!e&&-1;var o=Dn(s,n),a;if(e&&r!==r){for(;n>o;)if(a=i[o++],a!==a)return!0}else for(;n>o;o++)if((e||o in i)&&i[o]===r)return e||o||0;return!e&&-1}},Mn={includes:Lt(!0),indexOf:Lt(!1)},jn=R,$e=A,Bn=qe,xn=Mn.indexOf,Hn=Cr,At=jn([].push),Gn=function(e,t){var r=Bn(e),s=0,i=[],n;for(n in r)!$e(Hn,n)&&$e(r,n)&&At(i,n);for(;t.length>s;)$e(r,n=t[s++])&&(~xn(i,n)||At(i,n));return i},Fn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Kn=Gn,Vn=Fn,Wn=Vn.concat("length","prototype");Rr.f=Object.getOwnPropertyNames||function(t){return Kn(t,Wn)};var _r={};_r.f=Object.getOwnPropertySymbols;var zn=or,Yn=R,Jn=Rr,Xn=_r,Qn=Y,Zn=Yn([].concat),qn=zn("Reflect","ownKeys")||function(t){var r=Jn.f(Qn(t)),s=Xn.f;return s?Zn(r,s(t)):r},$t=A,eo=qn,to=Xe,ro=pe,so=function(e,t,r){for(var s=eo(t),i=ro.f,n=to.f,o=0;o<s.length;o++){var a=s[o];!$t(e,a)&&!(r&&$t(r,a))&&i(e,a,n(t,a))}},io=N,no=w,oo=/#|\.prototype\./,J=function(e,t){var r=co[ao(e)];return r===uo?!0:r===lo?!1:no(t)?io(t):!!t},ao=J.normalize=function(e){return String(e).replace(oo,".").toLowerCase()},co=J.data={},lo=J.NATIVE="N",uo=J.POLYFILL="P",Nr=J,ee=T,ho=Xe.f,fo=pr,Eo=wn,vo=rt,go=so,So=Nr,To=function(e,t){var r=e.target,s=e.global,i=e.stat,n,o,a,c,l,h;if(s?o=ee:i?o=ee[r]||vo(r,{}):o=ee[r]&&ee[r].prototype,o)for(a in t){if(l=t[a],e.dontCallGetSet?(h=ho(o,a),c=h&&h.value):c=o[a],n=So(s?a:r+(i?".":"#")+a,e.forced),!n&&c!==void 0){if(typeof l==typeof c)continue;go(l,c)}(e.sham||c&&c.sham)&&fo(l,"sham",!0),Eo(o,a,l,e)}},Ur={},Dt=z,po=TypeError,mo=function(e){var t,r;this.promise=new e(function(s,i){if(t!==void 0||r!==void 0)throw new po("Bad Promise constructor");t=s,r=i}),this.resolve=Dt(t),this.reject=Dt(r)};Ur.f=function(e){return new mo(e)};var wo=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},Io=Te,Co=R,yo=function(e){if(Io(e)==="Function")return Co(e)},Pt=yo,bo=z,Ro=Qe,Oo=Pt(Pt.bind),ko=function(e,t){return bo(e),t===void 0?e:Ro?Oo(e,t):function(){return e.apply(t,arguments)}},Lr={},_o=$,No=Lr,Uo=_o("iterator"),Lo=Array.prototype,Ao=function(e){return e!==void 0&&(No.Array===e||Lo[Uo]===e)},$o=$,Do=$o("toStringTag"),Ar={};Ar[Do]="z";var Po=String(Ar)==="[object z]",Mo=Po,jo=w,ce=Te,Bo=$,xo=Bo("toStringTag"),Ho=Object,Go=ce(function(){return arguments}())==="Arguments",Fo=function(e,t){try{return e[t]}catch{}},Ko=Mo?ce:function(e){var t,r,s;return e===void 0?"Undefined":e===null?"Null":typeof(r=Fo(t=Ho(e),xo))=="string"?r:Go?ce(t):(s=ce(t))==="Object"&&jo(t.callee)?"Arguments":s},Vo=Ko,Mt=tt,Wo=Ze,zo=Lr,Yo=$,Jo=Yo("iterator"),$r=function(e){if(!Wo(e))return Mt(e,Jo)||Mt(e,"@@iterator")||zo[Vo(e)]},Xo=L,Qo=z,Zo=Y,qo=et,ea=$r,ta=TypeError,ra=function(e,t){var r=arguments.length<2?ea(e):t;if(Qo(r))return Zo(Xo(r,e));throw new ta(qo(e)+" is not iterable")},sa=L,jt=Y,ia=tt,na=function(e,t,r){var s,i;jt(e);try{if(s=ia(e,"return"),!s){if(t==="throw")throw r;return r}s=sa(s,e)}catch(n){i=!0,s=n}if(t==="throw")throw r;if(i)throw s;return jt(s),r},oa=ko,aa=L,ca=Y,la=et,ua=Ao,ha=kr,Bt=ar,da=ra,fa=$r,xt=na,Ea=TypeError,le=function(e,t){this.stopped=e,this.result=t},Ht=le.prototype,va=function(e,t,r){var s=r&&r.that,i=!!(r&&r.AS_ENTRIES),n=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),a=!!(r&&r.INTERRUPTED),c=oa(t,s),l,h,d,O,E,D,ct,lt=function(m){return l&&xt(l,"normal",m),new le(!0,m)},ut=function(m){return i?(ca(m),a?c(m[0],m[1],lt):c(m[0],m[1])):a?c(m,lt):c(m)};if(n)l=e.iterator;else if(o)l=e;else{if(h=fa(e),!h)throw new Ea(la(e)+" is not iterable");if(ua(h)){for(d=0,O=ha(e);O>d;d++)if(E=ut(e[d]),E&&Bt(Ht,E))return E;return new le(!1)}l=da(e,h)}for(D=n?e.next:l.next;!(ct=aa(D,l)).done;){try{E=ut(ct.value)}catch(m){xt(l,"throw",m)}if(typeof E=="object"&&E&&Bt(Ht,E))return E}return new le(!1)},ga=T,Dr=ga.Promise,Sa=$,Pr=Sa("iterator"),Mr=!1;try{var Ta=0,Gt={next:function(){return{done:!!Ta++}},return:function(){Mr=!0}};Gt[Pr]=function(){return this},Array.from(Gt,function(){throw 2})}catch{}var pa=function(e,t){try{if(!t&&!Mr)return!1}catch{return!1}var r=!1;try{var s={};s[Pr]=function(){return{next:function(){return{done:r=!0}}}},e(s)}catch{}return r},B=T,ma=cr,wa=Te,te=function(e){return ma.slice(0,e.length)===e},Ia=function(){return te("Bun/")?"BUN":te("Cloudflare-Workers")?"CLOUDFLARE":te("Deno/")?"DENO":te("Node.js/")?"NODE":B.Bun&&typeof Bun.version=="string"?"BUN":B.Deno&&typeof Deno.version=="object"?"DENO":wa(B.process)==="process"?"NODE":B.window&&B.document?"BROWSER":"REST"}(),Ca=T,G=Dr,ya=w,ba=Nr,Ra=Ir,Oa=$,Ft=Ia,De=ur;G&&G.prototype;var ka=Oa("species"),We=!1,jr=ya(Ca.PromiseRejectionEvent),_a=ba("Promise",function(){var e=Ra(G),t=e!==String(G);if(!t&&De===66)return!0;if(!De||De<51||!/native code/.test(e)){var r=new G(function(n){n(1)}),s=function(n){n(function(){},function(){})},i=r.constructor={};if(i[ka]=s,We=r.then(function(){})instanceof s,!We)return!0}return!t&&(Ft==="BROWSER"||Ft==="DENO")&&!jr}),Na={CONSTRUCTOR:_a,REJECTION_EVENT:jr,SUBCLASSING:We},Ua=Dr,La=pa,Aa=Na.CONSTRUCTOR,$a=Aa||!La(function(e){Ua.all(e).then(void 0,function(){})}),Da=To,Pa=L,Ma=z,ja=Ur,Ba=wo,xa=va,Ha=$a;Da({target:"Promise",stat:!0,forced:Ha},{allSettled:function(t){var r=this,s=ja.f(r),i=s.resolve,n=s.reject,o=Ba(function(){var a=Ma(r.resolve),c=[],l=0,h=1;xa(t,function(d){var O=l++,E=!1;h++,Pa(a,r,d).then(function(D){E||(E=!0,c[O]={status:"fulfilled",value:D},--h||i(c))},function(D){E||(E=!0,c[O]={status:"rejected",reason:D},--h||i(c))})}),--h||i(c)});return o.error&&n(o.value),s.promise}});const Ga="modulepreload",Fa=function(e){return new URL("./",import.meta.url).toString()+e},Kt={},_=function(t,r,s){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");i=Promise.allSettled(r.map(c=>{if(c=Fa(c),c in Kt)return;Kt[c]=!0;const l=c.endsWith(".css"),h=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":Ga,l||(d.as="script"),d.crossOrigin="",d.href=c,a&&d.setAttribute("nonce",a),document.head.appendChild(d),l)return new Promise((O,E)=>{d.addEventListener("load",O),d.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${c}`)))})}))}function n(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&n(a.reason);return t().catch(n)})};var F=e=>typeof e=="function"?e:function(){return e},Ka=typeof self<"u"?self:null,H=typeof window<"u"?window:null,K=Ka||H||K,Va="2.0.0",b={connecting:0,open:1,closing:2,closed:3},Wa=1e4,za=1e3,p={closed:"closed",errored:"errored",joined:"joined",joining:"joining",leaving:"leaving"},k={close:"phx_close",error:"phx_error",join:"phx_join",reply:"phx_reply",leave:"phx_leave"},ze={longpoll:"longpoll",websocket:"websocket"},Ya={complete:4},re=class{constructor(e,t,r,s){this.channel=e,this.event=t,this.payload=r||function(){return{}},this.receivedResp=null,this.timeout=s,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}resend(e){this.timeout=e,this.reset(),this.send()}send(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}receive(e,t){return this.hasReceived(e)&&t(this.receivedResp.response),this.recHooks.push({status:e,callback:t}),this}reset(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}matchReceive({status:e,response:t,_ref:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}cancelRefEvent(){this.refEvent&&this.channel.off(this.refEvent)}cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}startTimeout(){this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,e=>{this.cancelRefEvent(),this.cancelTimeout(),this.receivedResp=e,this.matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}trigger(e,t){this.channel.trigger(this.refEvent,{status:e,response:t})}},Br=class{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=null,this.tries=0}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}},Ja=class{constructor(e,t,r){this.state=p.closed,this.topic=e,this.params=F(t||{}),this.socket=r,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new re(this,k.join,this.params,this.timeout),this.pushBuffer=[],this.stateChangeRefs=[],this.rejoinTimer=new Br(()=>{this.socket.isConnected()&&this.rejoin()},this.socket.rejoinAfterMs),this.stateChangeRefs.push(this.socket.onError(()=>this.rejoinTimer.reset())),this.stateChangeRefs.push(this.socket.onOpen(()=>{this.rejoinTimer.reset(),this.isErrored()&&this.rejoin()})),this.joinPush.receive("ok",()=>{this.state=p.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this.joinPush.receive("error",()=>{this.state=p.errored,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.hasLogger()&&this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=p.closed,this.socket.remove(this)}),this.onError(s=>{this.socket.hasLogger()&&this.socket.log("channel",`error ${this.topic}`,s),this.isJoining()&&this.joinPush.reset(),this.state=p.errored,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.joinPush.receive("timeout",()=>{this.socket.hasLogger()&&this.socket.log("channel",`timeout ${this.topic} (${this.joinRef()})`,this.joinPush.timeout),new re(this,k.leave,F({}),this.timeout).send(),this.state=p.errored,this.joinPush.reset(),this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.on(k.reply,(s,i)=>{this.trigger(this.replyEventName(i),s)})}join(e=this.timeout){if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=e,this.joinedOnce=!0,this.rejoin(),this.joinPush}onClose(e){this.on(k.close,e)}onError(e){return this.on(k.error,t=>e(t))}on(e,t){let r=this.bindingRef++;return this.bindings.push({event:e,ref:r,callback:t}),r}off(e,t){this.bindings=this.bindings.filter(r=>!(r.event===e&&(typeof t>"u"||t===r.ref)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(e,t,r=this.timeout){if(t=t||{},!this.joinedOnce)throw new Error(`tried to push '${e}' to '${this.topic}' before joining. Use channel.join() before pushing events`);let s=new re(this,e,function(){return t},r);return this.canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}leave(e=this.timeout){this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=p.leaving;let t=()=>{this.socket.hasLogger()&&this.socket.log("channel",`leave ${this.topic}`),this.trigger(k.close,"leave")},r=new re(this,k.leave,F({}),e);return r.receive("ok",()=>t()).receive("timeout",()=>t()),r.send(),this.canPush()||r.trigger("ok",{}),r}onMessage(e,t,r){return t}isMember(e,t,r,s){return this.topic!==e?!1:s&&s!==this.joinRef()?(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:e,event:t,payload:r,joinRef:s}),!1):!0}joinRef(){return this.joinPush.ref}rejoin(e=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=p.joining,this.joinPush.resend(e))}trigger(e,t,r,s){let i=this.onMessage(e,t,r,s);if(t&&!i)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");let n=this.bindings.filter(o=>o.event===e);for(let o=0;o<n.length;o++)n[o].callback(i,r,s||this.joinRef())}replyEventName(e){return`chan_reply_${e}`}isClosed(){return this.state===p.closed}isErrored(){return this.state===p.errored}isJoined(){return this.state===p.joined}isJoining(){return this.state===p.joining}isLeaving(){return this.state===p.leaving}},ge=class{static request(e,t,r,s,i,n,o){if(K.XDomainRequest){let a=new K.XDomainRequest;return this.xdomainRequest(a,e,t,s,i,n,o)}else{let a=new K.XMLHttpRequest;return this.xhrRequest(a,e,t,r,s,i,n,o)}}static xdomainRequest(e,t,r,s,i,n,o){return e.timeout=i,e.open(t,r),e.onload=()=>{let a=this.parseJSON(e.responseText);o&&o(a)},n&&(e.ontimeout=n),e.onprogress=()=>{},e.send(s),e}static xhrRequest(e,t,r,s,i,n,o,a){return e.open(t,r,!0),e.timeout=n,e.setRequestHeader("Content-Type",s),e.onerror=()=>a&&a(null),e.onreadystatechange=()=>{if(e.readyState===Ya.complete&&a){let c=this.parseJSON(e.responseText);a(c)}},o&&(e.ontimeout=o),e.send(i),e}static parseJSON(e){if(!e||e==="")return null;try{return JSON.parse(e)}catch{return console&&console.log("failed to parse JSON response",e),null}}static serialize(e,t){let r=[];for(var s in e){if(!Object.prototype.hasOwnProperty.call(e,s))continue;let i=t?`${t}[${s}]`:s,n=e[s];typeof n=="object"?r.push(this.serialize(n,i)):r.push(encodeURIComponent(i)+"="+encodeURIComponent(n))}return r.join("&")}static appendParams(e,t){if(Object.keys(t).length===0)return e;let r=e.match(/\?/)?"&":"?";return`${e}${r}${this.serialize(t)}`}},Pe=class{constructor(e){this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.reqs=new Set,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(e),this.readyState=b.connecting,this.poll()}normalizeEndpoint(e){return e.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+ze.websocket),"$1/"+ze.longpoll)}endpointURL(){return ge.appendParams(this.pollEndpoint,{token:this.token})}closeAndRetry(e,t,r){this.close(e,t,r),this.readyState=b.connecting}ontimeout(){this.onerror("timeout"),this.closeAndRetry(1005,"timeout",!1)}isActive(){return this.readyState===b.open||this.readyState===b.connecting}poll(){this.ajax("GET",null,()=>this.ontimeout(),e=>{if(e){var{status:t,token:r,messages:s}=e;this.token=r}else t=0;switch(t){case 200:s.forEach(i=>{setTimeout(()=>this.onmessage({data:i}),0)}),this.poll();break;case 204:this.poll();break;case 410:this.readyState=b.open,this.onopen({}),this.poll();break;case 403:this.onerror(403),this.close(1008,"forbidden",!1);break;case 0:case 500:this.onerror(500),this.closeAndRetry(1011,"internal server error",500);break;default:throw new Error(`unhandled poll status ${t}`)}})}send(e){this.ajax("POST",e,()=>this.onerror("timeout"),t=>{(!t||t.status!==200)&&(this.onerror(t&&t.status),this.closeAndRetry(1011,"internal server error",!1))})}close(e,t,r){for(let i of this.reqs)i.abort();this.readyState=b.closed;let s=Object.assign({code:1e3,reason:void 0,wasClean:!0},{code:e,reason:t,wasClean:r});typeof CloseEvent<"u"?this.onclose(new CloseEvent("close",s)):this.onclose(s)}ajax(e,t,r,s){let i,n=()=>{this.reqs.delete(i),r()};i=ge.request(e,this.endpointURL(),"application/json",t,this.timeout,n,o=>{this.reqs.delete(i),this.isActive()&&s(o)}),this.reqs.add(i)}},se={HEADER_LENGTH:1,META_LENGTH:4,KINDS:{push:0,reply:1,broadcast:2},encode(e,t){if(e.payload.constructor===ArrayBuffer)return t(this.binaryEncode(e));{let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}},decode(e,t){if(e.constructor===ArrayBuffer)return t(this.binaryDecode(e));{let[r,s,i,n,o]=JSON.parse(e);return t({join_ref:r,ref:s,topic:i,event:n,payload:o})}},binaryEncode(e){let{join_ref:t,ref:r,event:s,topic:i,payload:n}=e,o=this.META_LENGTH+t.length+r.length+i.length+s.length,a=new ArrayBuffer(this.HEADER_LENGTH+o),c=new DataView(a),l=0;c.setUint8(l++,this.KINDS.push),c.setUint8(l++,t.length),c.setUint8(l++,r.length),c.setUint8(l++,i.length),c.setUint8(l++,s.length),Array.from(t,d=>c.setUint8(l++,d.charCodeAt(0))),Array.from(r,d=>c.setUint8(l++,d.charCodeAt(0))),Array.from(i,d=>c.setUint8(l++,d.charCodeAt(0))),Array.from(s,d=>c.setUint8(l++,d.charCodeAt(0)));var h=new Uint8Array(a.byteLength+n.byteLength);return h.set(new Uint8Array(a),0),h.set(new Uint8Array(n),a.byteLength),h.buffer},binaryDecode(e){let t=new DataView(e),r=t.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.push:return this.decodePush(e,t,s);case this.KINDS.reply:return this.decodeReply(e,t,s);case this.KINDS.broadcast:return this.decodeBroadcast(e,t,s)}},decodePush(e,t,r){let s=t.getUint8(1),i=t.getUint8(2),n=t.getUint8(3),o=this.HEADER_LENGTH+this.META_LENGTH-1,a=r.decode(e.slice(o,o+s));o=o+s;let c=r.decode(e.slice(o,o+i));o=o+i;let l=r.decode(e.slice(o,o+n));o=o+n;let h=e.slice(o,e.byteLength);return{join_ref:a,ref:null,topic:c,event:l,payload:h}},decodeReply(e,t,r){let s=t.getUint8(1),i=t.getUint8(2),n=t.getUint8(3),o=t.getUint8(4),a=this.HEADER_LENGTH+this.META_LENGTH,c=r.decode(e.slice(a,a+s));a=a+s;let l=r.decode(e.slice(a,a+i));a=a+i;let h=r.decode(e.slice(a,a+n));a=a+n;let d=r.decode(e.slice(a,a+o));a=a+o;let O=e.slice(a,e.byteLength),E={status:d,response:O};return{join_ref:c,ref:l,topic:h,event:k.reply,payload:E}},decodeBroadcast(e,t,r){let s=t.getUint8(1),i=t.getUint8(2),n=this.HEADER_LENGTH+2,o=r.decode(e.slice(n,n+s));n=n+s;let a=r.decode(e.slice(n,n+i));n=n+i;let c=e.slice(n,e.byteLength);return{join_ref:null,ref:null,topic:o,event:a,payload:c}}},Xa=class{constructor(e,t={}){this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=t.timeout||Wa,this.transport=t.transport||K.WebSocket||Pe,this.establishedConnections=0,this.defaultEncoder=se.encode.bind(se),this.defaultDecoder=se.decode.bind(se),this.closeWasClean=!1,this.binaryType=t.binaryType||"arraybuffer",this.connectClock=1,this.transport!==Pe?(this.encode=t.encode||this.defaultEncoder,this.decode=t.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder);let r=null;H&&H.addEventListener&&(H.addEventListener("pagehide",s=>{this.conn&&(this.disconnect(),r=this.connectClock)}),H.addEventListener("pageshow",s=>{r===this.connectClock&&(r=null,this.connect())})),this.heartbeatIntervalMs=t.heartbeatIntervalMs||3e4,this.rejoinAfterMs=s=>t.rejoinAfterMs?t.rejoinAfterMs(s):[1e3,2e3,5e3][s-1]||1e4,this.reconnectAfterMs=s=>t.reconnectAfterMs?t.reconnectAfterMs(s):[10,50,100,150,200,250,500,1e3,2e3][s-1]||5e3,this.logger=t.logger||null,this.longpollerTimeout=t.longpollerTimeout||2e4,this.params=F(t.params||{}),this.endPoint=`${e}/${ze.websocket}`,this.vsn=t.vsn||Va,this.heartbeatTimeoutTimer=null,this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new Br(()=>{this.teardown(()=>this.connect())},this.reconnectAfterMs)}getLongPollTransport(){return Pe}replaceTransport(e){this.connectClock++,this.closeWasClean=!0,this.reconnectTimer.reset(),this.sendBuffer=[],this.conn&&(this.conn.close(),this.conn=null),this.transport=e}protocol(){return location.protocol.match(/^https/)?"wss":"ws"}endPointURL(){let e=ge.appendParams(ge.appendParams(this.endPoint,this.params()),{vsn:this.vsn});return e.charAt(0)!=="/"?e:e.charAt(1)==="/"?`${this.protocol()}:${e}`:`${this.protocol()}://${location.host}${e}`}disconnect(e,t,r){this.connectClock++,this.closeWasClean=!0,this.reconnectTimer.reset(),this.teardown(e,t,r)}connect(e){e&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=F(e)),!this.conn&&(this.connectClock++,this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=()=>this.onConnOpen(),this.conn.onerror=t=>this.onConnError(t),this.conn.onmessage=t=>this.onConnMessage(t),this.conn.onclose=t=>this.onConnClose(t))}log(e,t,r){this.logger(e,t,r)}hasLogger(){return this.logger!==null}onOpen(e){let t=this.makeRef();return this.stateChangeCallbacks.open.push([t,e]),t}onClose(e){let t=this.makeRef();return this.stateChangeCallbacks.close.push([t,e]),t}onError(e){let t=this.makeRef();return this.stateChangeCallbacks.error.push([t,e]),t}onMessage(e){let t=this.makeRef();return this.stateChangeCallbacks.message.push([t,e]),t}ping(e){if(!this.isConnected())return!1;let t=this.makeRef(),r=Date.now();this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:t});let s=this.onMessage(i=>{i.ref===t&&(this.off([s]),e(Date.now()-r))});return!0}clearHeartbeats(){clearTimeout(this.heartbeatTimer),clearTimeout(this.heartbeatTimeoutTimer)}onConnOpen(){this.hasLogger()&&this.log("transport",`connected to ${this.endPointURL()}`),this.closeWasClean=!1,this.establishedConnections++,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach(([,e])=>e())}heartbeatTimeout(){this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.triggerChanError(),this.closeWasClean=!1,this.teardown(()=>this.reconnectTimer.scheduleTimeout(),za,"heartbeat timeout"))}resetHeartbeat(){this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,this.clearHeartbeats(),this.heartbeatTimer=setTimeout(()=>this.sendHeartbeat(),this.heartbeatIntervalMs))}teardown(e,t,r){if(!this.conn)return e&&e();this.waitForBufferDone(()=>{this.conn&&(t?this.conn.close(t,r||""):this.conn.close()),this.waitForSocketClosed(()=>{this.conn&&(this.conn.onopen=function(){},this.conn.onerror=function(){},this.conn.onmessage=function(){},this.conn.onclose=function(){},this.conn=null),e&&e()})})}waitForBufferDone(e,t=1){if(t===5||!this.conn||!this.conn.bufferedAmount){e();return}setTimeout(()=>{this.waitForBufferDone(e,t+1)},150*t)}waitForSocketClosed(e,t=1){if(t===5||!this.conn||this.conn.readyState===b.closed){e();return}setTimeout(()=>{this.waitForSocketClosed(e,t+1)},150*t)}onConnClose(e){let t=e&&e.code;this.hasLogger()&&this.log("transport","close",e),this.triggerChanError(),this.clearHeartbeats(),!this.closeWasClean&&t!==1e3&&this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(([,r])=>r(e))}onConnError(e){this.hasLogger()&&this.log("transport",e);let t=this.transport,r=this.establishedConnections;this.stateChangeCallbacks.error.forEach(([,s])=>{s(e,t,r)}),(t===this.transport||r>0)&&this.triggerChanError()}triggerChanError(){this.channels.forEach(e=>{e.isErrored()||e.isLeaving()||e.isClosed()||e.trigger(k.error)})}connectionState(){switch(this.conn&&this.conn.readyState){case b.connecting:return"connecting";case b.open:return"open";case b.closing:return"closing";default:return"closed"}}isConnected(){return this.connectionState()==="open"}remove(e){this.off(e.stateChangeRefs),this.channels=this.channels.filter(t=>t.joinRef()!==e.joinRef())}off(e){for(let t in this.stateChangeCallbacks)this.stateChangeCallbacks[t]=this.stateChangeCallbacks[t].filter(([r])=>e.indexOf(r)===-1)}channel(e,t={}){let r=new Ja(e,t,this);return this.channels.push(r),r}push(e){if(this.hasLogger()){let{topic:t,event:r,payload:s,ref:i,join_ref:n}=e;this.log("push",`${t} ${r} (${n}, ${i})`,s)}this.isConnected()?this.encode(e,t=>this.conn.send(t)):this.sendBuffer.push(()=>this.encode(e,t=>this.conn.send(t)))}makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}sendHeartbeat(){this.pendingHeartbeatRef&&!this.isConnected()||(this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatTimeoutTimer=setTimeout(()=>this.heartbeatTimeout(),this.heartbeatIntervalMs))}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:n,join_ref:o}=t;n&&n===this.pendingHeartbeatRef&&(this.clearHeartbeats(),this.pendingHeartbeatRef=null,this.heartbeatTimer=setTimeout(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)),this.hasLogger()&&this.log("receive",`${i.status||""} ${r} ${s} ${n&&"("+n+")"||""}`,i);for(let a=0;a<this.channels.length;a++){const c=this.channels[a];c.isMember(r,s,i,o)&&c.trigger(s,i,n,o)}for(let a=0;a<this.stateChangeCallbacks.message.length;a++){let[,c]=this.stateChangeCallbacks.message[a];c(t)}})}leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r.isJoined()||r.isJoining()));t&&(this.hasLogger()&&this.log("transport",`leaving duplicate topic "${e}"`),t.leave())}},ie,Qa=new Uint8Array(16);function Za(){if(!ie&&(ie=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!ie))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ie(Qa)}const qa=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function ec(e){return typeof e=="string"&&qa.test(e)}var v=[];for(var Me=0;Me<256;++Me)v.push((Me+256).toString(16).substr(1));function tc(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(v[e[t+0]]+v[e[t+1]]+v[e[t+2]]+v[e[t+3]]+"-"+v[e[t+4]]+v[e[t+5]]+"-"+v[e[t+6]]+v[e[t+7]]+"-"+v[e[t+8]]+v[e[t+9]]+"-"+v[e[t+10]]+v[e[t+11]]+v[e[t+12]]+v[e[t+13]]+v[e[t+14]]+v[e[t+15]]).toLowerCase();if(!ec(r))throw TypeError("Stringified UUID is invalid");return r}function Vt(e,t,r){e=e||{};var s=e.random||(e.rng||Za)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=s[i];return t}return tc(s)}class f extends Error{constructor(t,r,s){super(t),Object.setPrototypeOf(this,f.prototype),this.name="UserflowError",this.code=r,this.humanMessage=s}}class xr{constructor(t){this.type=t,this.testState={}}formatKey(t){return`userflow:${t}`}isSupported(){if(typeof window>"u")return!1;try{return window[this.type]!=null}catch{return!1}}getItem(t){return t=this.formatKey(t),this.isSupported()?window[this.type].getItem(t):null}setItem(t,r){t=this.formatKey(t);{if(!this.isSupported())return;window[this.type].setItem(t,r)}}removeItem(t){return t=this.formatKey(t),this.isSupported()?window[this.type].removeItem(t):void 0}clear(){return this.isSupported()?window[this.type].clear():void 0}}const ne=new xr("localStorage"),g=new xr("sessionStorage");function ul(e){window.location.href=e}function ue(){return window.location.href}function Ye(e){window.postMessage(e,window.origin)}function Hr(e){const t=s=>{if(s.source!==window||s.origin!==window.origin)return;const i=s.data;!i||typeof i!="object"||typeof i.kind!="string"||!i.kind.startsWith("userflow:")||e(i)===!0&&r()};window.addEventListener("message",t);const r=()=>window.removeEventListener("message",t);return r}function rc(e){return new Promise(t=>{Hr(r=>{const s=e(r);return s?(t(s),!0):!1})})}const ot=new Set;let Wt=!1;function sc(e){return ic(),ot.add(e),()=>{Gr(e)}}function Gr(e){ot.delete(e)}function oe(){ot.forEach(e=>e())}function ic(){if(Wt)return;Wt=!0;const{history:e}=window,t=r=>{const s=e[r];e[r]=(...i)=>{const n=s.apply(e,i);return oe(),n}};window.__userflowStatePatched?(window.addEventListener("userflow:pushstate",()=>{oe()}),window.addEventListener("userflow:replacestate",()=>{oe()})):(t("pushState"),t("replaceState")),window.addEventListener("popstate",()=>{oe()})}class nc{destroy(){this.unregisterOnMessage&&this.unregisterOnMessage()}postBuilderMessage(t){Ye({kind:"userflow:crxSendProxyMessage",direction:"targetToBuilder",message:t})}onBuilderMessage(t){return this.unregisterOnMessage=Hr(t),!1}async captureScreenshot(t,r,s,i){return Ye({kind:"userflow:crxScreenshot",x:t,y:r,width:s,height:i,devicePixelRatio:window.devicePixelRatio}),(await rc(o=>o.kind==="userflow:crxScreenshotResult"?o:null)).imageDataUrl}}var he=(e=>(e.ACTION="ACTION",e.LAUNCHER_DEACTIVATED="LAUNCHER_DEACTIVATED",e.REPLACED="REPLACED",e.SNOOZED="SNOOZED",e.TOOLTIP_TARGET_MISSING="TOOLTIP_TARGET_MISSING",e.USERFLOWJS="USERFLOWJS",e.USER_CLOSED="USER_CLOSED",e))(he||{}),oc=(e=>(e.SECOND="SECOND",e.MINUTE="MINUTE",e.HOUR="HOUR",e.DAY="DAY",e))(oc||{}),Se=(e=>(e.ACTION="ACTION",e.DRAFT="DRAFT",e.LINK="LINK",e.LAUNCHER_SEEN="LAUNCHER_SEEN",e.RESOURCE_CENTER="RESOURCE_CENTER",e.USERFLOWJS="USERFLOWJS",e.ASSISTANT="ASSISTANT",e))(Se||{}),ac=(e=>(e.LIKE="LIKE",e.DISLIKE="DISLIKE",e))(ac||{}),y=(e=>(e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.NUMBER="NUMBER",e.DATETIME="DATETIME",e.LIST="LIST",e.RANDOM_AB="RANDOM_AB",e.RANDOM_NUMBER="RANDOM_NUMBER",e.CHECKLIST_TASK="CHECKLIST_TASK",e.FLOW="FLOW",e.FLOW_SESSION="FLOW_SESSION",e.FLOW_STEP="FLOW_STEP",e.FLOW_VERSION="FLOW_VERSION",e))(y||{}),de=(e=>(e.FLOW="FLOW",e.BANNER="BANNER",e.EMBED="EMBED",e.CHECKLIST="CHECKLIST",e.LAUNCHER="LAUNCHER",e.RESOURCE_CENTER="RESOURCE_CENTER",e.SITE="SITE",e))(de||{}),cc=(e=>(e.ALWAYS_TRUE="ALWAYS_TRUE",e.ATTRIBUTE="ATTRIBUTE",e.CHECKLIST_TASK_CLICKED="CHECKLIST_TASK_CLICKED",e.CLAUSE="CLAUSE",e.ELEMENT="ELEMENT",e.EVENT="EVENT",e.FILLED_IN_INPUT="FILLED_IN_INPUT",e.FLOW="FLOW",e.INPUT_VALUE="INPUT_VALUE",e.PAGE="PAGE",e.SEGMENT="SEGMENT",e.TIME="TIME",e))(cc||{}),lc=(e=>(e.AUTO="AUTO",e.MANUAL="MANUAL",e))(lc||{}),uc=(e=>(e.INPUT="INPUT",e))(uc||{}),hc=(e=>(e.ABSOLUTE_EQ="ABSOLUTE_EQ",e.ABSOLUTE_GT="ABSOLUTE_GT",e.ABSOLUTE_LT="ABSOLUTE_LT",e.AND="AND",e.BETWEEN="BETWEEN",e.CONTAINS="CONTAINS",e.EMPTY="EMPTY",e.ENDS_WITH="ENDS_WITH",e.EQ="EQ",e.EXCLUDES_ALL="EXCLUDES_ALL",e.EXCLUDES_ANY="EXCLUDES_ANY",e.FALSE="FALSE",e.GT="GT",e.GTE="GTE",e.INCLUDES_ALL="INCLUDES_ALL",e.INCLUDES_ANY="INCLUDES_ANY",e.LT="LT",e.LTE="LTE",e.NE="NE",e.NOT_CONTAINS="NOT_CONTAINS",e.NOT_EMPTY="NOT_EMPTY",e.NOT_REGEX="NOT_REGEX",e.OR="OR",e.REGEX="REGEX",e.RELATIVE_EQ="RELATIVE_EQ",e.RELATIVE_GT="RELATIVE_GT",e.RELATIVE_LT="RELATIVE_LT",e.STARTS_WITH="STARTS_WITH",e.TRUE="TRUE",e.URL="URL",e))(hc||{}),dc=(e=>(e.CLICK="CLICK",e.DISABLED="DISABLED",e.MOUSEDOWN="MOUSEDOWN",e.NOT_CLICK="NOT_CLICK",e.NOT_DISABLED="NOT_DISABLED",e.NOT_PRESENT="NOT_PRESENT",e.PRESENT="PRESENT",e))(dc||{}),fc=(e=>(e.END_USER="END_USER",e.GROUP="GROUP",e))(fc||{}),Ec=(e=>(e.BETWEEN="BETWEEN",e.EQ="EQ",e.GTE="GTE",e.LTE="LTE",e))(Ec||{}),vc=(e=>(e.ANY="ANY",e.RELATIVE_BETWEEN="RELATIVE_BETWEEN",e.RELATIVE_GT="RELATIVE_GT",e.RELATIVE_LT="RELATIVE_LT",e))(vc||{}),gc=(e=>(e.CURRENT_USER="CURRENT_USER",e.CURRENT_USER_CURRENT_GROUP="CURRENT_USER_CURRENT_GROUP",e.CURRENT_GROUP="CURRENT_GROUP",e))(gc||{}),Sc=(e=>(e.ASSET="ASSET",e.CARTOON="CARTOON",e.NONE="NONE",e.URL="URL",e))(Sc||{}),Tc=(e=>(e.INSIDE="INSIDE",e.OUTSIDE="OUTSIDE",e))(Tc||{}),pc=(e=>(e.TOP_LEFT="TOP_LEFT",e.TOP_CENTER="TOP_CENTER",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_RIGHT="BOTTOM_RIGHT",e.BOTTOM_CENTER="BOTTOM_CENTER",e.BOTTOM_LEFT="BOTTOM_LEFT",e.CENTER="CENTER",e))(pc||{}),mc=(e=>(e.GOOGLE="GOOGLE",e.STANDARD="STANDARD",e))(mc||{}),wc=(e=>(e.DISMISS_FIRST_MENU_AFTER="DISMISS_FIRST_MENU_AFTER",e.DISMISS="DISMISS",e))(wc||{}),Ic=(e=>(e.DISMISS="DISMISS",e.NONE="NONE",e))(Ic||{}),Cc=(e=>(e.DEFAULT="DEFAULT",e.NARROW="NARROW",e.CHAINED_SQUARED="CHAINED_SQUARED",e.CHAINED_ROUNDED="CHAINED_ROUNDED",e.DOTTED="DOTTED",e.NUMBERED="NUMBERED",e))(Cc||{}),yc=(e=>(e.TOP="TOP",e.BOTTOM="BOTTOM",e))(yc||{}),bc=(e=>(e.DEFAULT="DEFAULT",e.PLAINTEXT="PLAINTEXT",e.CUSTOM="CUSTOM",e))(bc||{}),Rc=(e=>(e.CHECKLIST_OVERRIDE="CHECKLIST_OVERRIDE",e.RESOURCE_CENTER_ONLY="RESOURCE_CENTER_ONLY",e.NONE="NONE",e))(Rc||{}),Oc=(e=>(e.BUBBLE="BUBBLE",e.END="END",e.ERROR="ERROR",e.FLAG="FLAG",e))(Oc||{}),kc=(e=>(e.MANUAL="MANUAL",e.NONE="NONE",e.SYNTHETIC="SYNTHETIC",e))(kc||{}),_c=(e=>(e.BUBBLE="BUBBLE",e.HIDDEN="HIDDEN",e.MODAL="MODAL",e.TOOLTIP="TOOLTIP",e))(_c||{}),Nc=(e=>(e.ABOVE="ABOVE",e.BELOW="BELOW",e.LEFT="LEFT",e.RIGHT="RIGHT",e))(Nc||{}),Uc=(e=>(e.CLOSE_FLOW="CLOSE_FLOW",e.EVAL_JS="EVAL_JS",e.GO_TO_STEP="GO_TO_STEP",e.NAVIGATE="NAVIGATE",e.SET_ATTRIBUTE="SET_ATTRIBUTE",e.SNOOZE="SNOOZE",e.START_FLOW="START_FLOW",e.TRACK_BUTTON_EVENT="TRACK_BUTTON_EVENT",e))(Uc||{}),Lc=(e=>(e.NEW_TAB="NEW_TAB",e.SAME_TAB="SAME_TAB",e))(Lc||{}),Ac=(e=>(e.SET="SET",e.SET_DATETIME="SET_DATETIME",e.SET_DATETIME_ONCE="SET_DATETIME_ONCE",e.SET_ONCE="SET_ONCE",e.ADD="ADD",e.SUBTRACT="SUBTRACT",e.APPEND="APPEND",e.PREPEND="PREPEND",e.REMOVE="REMOVE",e.UNSET="UNSET",e))(Ac||{}),$c=(e=>(e.MULTILINE_TEXT="MULTILINE_TEXT",e.MULTIPLE_CHOICE="MULTIPLE_CHOICE",e.NPS="NPS",e.SCALE="SCALE",e.STARS="STARS",e.TEXT="TEXT",e))($c||{}),Je=(e=>(e.ACTION="ACTION",e.ANNOUNCEMENTS="ANNOUNCEMENTS",e.ASSISTANT="ASSISTANT",e.CHECKLIST="CHECKLIST",e.CONTACT="CONTACT",e.DIVIDER="DIVIDER",e.FLOWS="FLOWS",e.KNOWLEDGE_BASE="KNOWLEDGE_BASE",e.MESSAGE="MESSAGE",e.SUBPAGE="SUBPAGE",e))(Je||{}),Dc=(e=>(e.CRISP="CRISP",e.CUSTOM="CUSTOM",e.FRESHCHAT="FRESHCHAT",e.HELPSCOUT="HELPSCOUT",e.HUBSPOT="HUBSPOT",e.INTERCOM="INTERCOM",e.ZENDESK="ZENDESK",e.ZENDESK_MESSENGER="ZENDESK_MESSENGER",e))(Dc||{}),Pc=(e=>(e.BUTTON="BUTTON",e.INPUT="INPUT",e))(Pc||{}),Mc=(e=>(e.EMAIL="EMAIL",e.PHONE="PHONE",e.CHAT="CHAT",e))(Mc||{}),jc=(e=>(e.SILENT="SILENT",e.BADGE="BADGE",e.POPOUT="POPOUT",e.MODAL="MODAL",e.TOAST="TOAST",e))(jc||{}),Bc=(e=>(e.DEFAULT="DEFAULT",e.CUSTOM="CUSTOM",e.NONE="NONE",e))(Bc||{}),xc=(e=>(e.LAUNCHER_CLICK="LAUNCHER_CLICK",e.LAUNCHER_HOVER="LAUNCHER_HOVER",e.TARGET_CLICK="TARGET_CLICK",e.TARGET_HOVER="TARGET_HOVER",e.LAUNCHER_TARGET_CLICK="LAUNCHER_TARGET_CLICK",e.LAUNCHER_TARGET_HOVER="LAUNCHER_TARGET_HOVER",e))(xc||{}),Fr=(e=>(e.ACTIVATE="ACTIVATE",e.DEACTIVATE="DEACTIVATE",e.NEVER="NEVER",e))(Fr||{}),Hc=(e=>(e.AUTO="AUTO",e.TOP="TOP",e.RIGHT="RIGHT",e.BOTTOM="BOTTOM",e.LEFT="LEFT",e))(Hc||{}),Gc=(e=>(e.START="START",e.CENTER="CENTER",e.END="END",e))(Gc||{}),Fc=(e=>(e.PERCENT="PERCENT",e.PX="PX",e))(Fc||{}),Kc=(e=>(e.BEACON="BEACON",e.BUTTON="BUTTON",e.HIDDEN="HIDDEN",e.ICON="ICON",e))(Kc||{}),Vc=(e=>(e.LAUNCHER="LAUNCHER",e.TARGET="TARGET",e))(Vc||{}),Wc=(e=>(e.BODY_FIRST="BODY_FIRST",e.BODY_LAST="BODY_LAST",e.ELEMENT_FIRST="ELEMENT_FIRST",e.ELEMENT_LAST="ELEMENT_LAST",e.ELEMENT_BEFORE="ELEMENT_BEFORE",e.ELEMENT_AFTER="ELEMENT_AFTER",e))(Wc||{}),zc=(e=>(e.BODY_FIRST="BODY_FIRST",e.BODY_LAST="BODY_LAST",e.ELEMENT_FIRST="ELEMENT_FIRST",e.ELEMENT_LAST="ELEMENT_LAST",e.ELEMENT_BEFORE="ELEMENT_BEFORE",e.ELEMENT_AFTER="ELEMENT_AFTER",e))(zc||{}),Kr=(e=>(e.CHECKLIST="CHECKLIST",e))(Kr||{}),Yc=(e=>(e.HIDE="HIDE",e.OTHERS="OTHERS",e))(Yc||{}),Jc=(e=>(e.ALWAYS="ALWAYS",e.MULTIPLE="MULTIPLE",e.NEVER="NEVER",e.ONCE="ONCE",e.ONCE_PER_GROUP="ONCE_PER_GROUP",e))(Jc||{}),Xc=(e=>(e.NONE="NONE",e.PENDING_SCHEDULE="PENDING_SCHEDULE",e.SCHEDULED="SCHEDULED",e.FIRED="FIRED",e))(Xc||{}),Qc=(e=>(e.NONE="NONE",e.LIKE="LIKE",e.SCALE="SCALE",e))(Qc||{}),Zc=(e=>(e.HIDE="HIDE",e.BLOCK="BLOCK",e.OTHERS="OTHERS",e))(Zc||{});function qc(){return{customInputs:[],customNavigate:null,urlFilter:null,linkUrlDecorator:null,customScrollIntoView:null,scrollPadding:null,inferenceAttributeNames:["data-for","data-id","data-testid","data-test-id","for","id","name","placeholder","role"],inferenceAttributeFilters:{id:[e=>!e.match(/\d$/)],"data-id":[e=>!e.match(/\d$/)]},inferenceClassNameFilters:[e=>!e.startsWith("css-")],baseZIndex:1234500,evalJsDisabled:!1}}const S=qc();function zt(e){return Array.isArray(e)||(e=e?[e]:[]),e=e.map(t=>typeof t=="string"?new RegExp(t):t),e}function hl(e,t){return e.every(r=>typeof r=="function"?r(t):r instanceof RegExp?r.test(t):!0)}function el(){let e=ue();if(S.urlFilter){if(e=S.urlFilter(e),typeof e!="string")throw new f("Userflow.js: URL filter returned non-string value. Please check your userflow.setUrlFilter() implementation.");try{new URL(e)}catch(t){throw new f(`Userflow.js: URL filter returned an invalid URL. Please check your userflow.setUrlFilter() implementation.
Returned URL: `+e+`
Error message: `+t.message)}}return e}let Vr="";try{Vr=localStorage.getItem("debug")||""}catch{}const Wr=Vr.split(",").some(e=>e==="*"||e.startsWith("userflow:*")),u=at("log");u.group=at("group");u.groupCollapsed=at("groupCollapsed");u.groupEnd=function(){Wr&&console.groupEnd()};let je;function at(e){return function(t,...r){if(Wr){const s=performance.now(),i=je?Math.round(s-je):0;je=s,console[e](`%cuserflow %c${t} %c+${i}ms`,"color:#1a57e6;","","color:#1a57e6;",...r)}}}const tl=()=>_(()=>import("./ResourceCenterApp.v1.DxGbj0O9.js").then(e=>e.R),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]));function rl(e){const r=e.version.checklist.tasks.length;return Math.max(0,r-e.taskCompletions.length)}class Yt{constructor(t){this.observers=new Set,this._value=t}get value(){return this._value}update(t){if(t!==this._value){this._value=t;for(const r of this.observers)r()}}observe(t){return this.observers.add(t),()=>this.observers.delete(t)}}const Jt=["page:before-change","page:change","turbo:before-cache","turbo:load","turbo:visit","turbolinks:before-cache","turbolinks:load","turbolinks:visit","livewire:navigated","livewire:navigating","livewire:update"],sl=()=>_(()=>import("./BannerApp.v1.C4IpNGe9.js"),__vite__mapDeps([19,1,2,8,7,5,6,4,9,3,10,11,18,12])),Be="1020123",il=import.meta.url,Xt=50,nl=5*60*1e3,Qt="userflowClientState",x="userflowClientSiteId";class ol{constructor(){this.clientToken=null,this.externalId=null,this.signature=null,this.groupId=null,this.groupSignature=null,this._socketStatus="disconnected",this.socket=null,this.channel=null,this.logrocketAppId=null,this.debounceInactiveDisconnectTimeout=void 0,this.inBatch=!1,this.endBatchTimeout=void 0,this.pushRateLimitMinute=0,this.pushRateLimitMinuteExpires=0,this.clientClock=1,this.serverClock=1,this.flowSession=null,this.flowSessionClock=0,this.checklistSession=null,this.checklistExpanded=!1,this.checklistExpandPending=!1,this.checklistSessionClock=0,this.bannerSession=null,this.resourceCenterSession=null,this.resourceCenterOpen=!1,this.resourceCenterLauncherHidden=null,this.siteSession=null,this.launcherSessions=[],this.activeLauncherFlowId=null,this.notifications=[],this.embedSessions=[],this.notificationIdCounter=0,this.sessionStorageState=null,this.clientContext=null,this.flushUrlChangeTimeout=void 0,this.onFirstIdentifyRun=!1,this.onFirstIdentifyTimeout=void 0,this.firstIdentifyCallback=null,this.ui=null,this.debuggerUI=null,this.debuggerMountInProgress=!1,this.unackedTasks=new Set,this.clientConditions=new Map,this.trackers=new Map,this.conditionWaitTimers=new Map,this.listeners=new Map,this.targetEnv=null,this.idempotencyKeysSeen=new Set,this.testUserIdentified=!1,this.cspIssueReported=!1,this.uiDisabled=!1,this.audio=null,this.audioReady=!1,this.pageTrackingDisabled=!1,this.refCounter=1,this.implicitTracking=null,this.initialMessagesQueue=[],this.onBuilderMessage=t=>(this.handleBuilderMessage(t),!1),this.handleBuilderMessage=async t=>{u(`builder ${t.kind} message received`,t);const r="idempotencyKey"in t&&typeof t.idempotencyKey=="string"?t.idempotencyKey:null;if(r&&this.idempotencyKeysSeen.has(r))return;const s=()=>{r&&this.idempotencyKeysSeen.add(r)};switch(t.kind){case"userflow:selectElement":{s(),this.getTargetEnv().postBuilderMessage({kind:"userflow:selectElementAck",idempotencyKey:t.idempotencyKey}),this.setSessionStorageState(i=>({...i,isTargetTab:!0,activeApp:"elementSelection",elementSelection:{mode:"select",elementType:t.elementType}}));return}case"userflow:selectElementCancel":{this.setSessionStorageState(i=>({...i,activeApp:null,elementSelection:null}));return}case"userflow:startFlowWithToken":{s(),this.getTargetEnv().postBuilderMessage({kind:"userflow:startFlowWithTokenAck",idempotencyKey:t.idempotencyKey}),this.setSessionStorageState(i=>({...i,isTargetTab:!0,activeApp:null,testStartConditionToken:void 0})),g.setItem("previewFlowId",t.flowId),t.testUser?this.identifyTestUser(t.testUser):this.resetTestUser(),t.testStartCondition?this.setSessionStorageState(i=>({...i,activeApp:"startConditionTesting",testStartConditionToken:t.token})):this.onceIdentified(()=>{if(this.startFlowWithToken(t.token),t.isResourceCenter){const i=()=>{const n=this.resourceCenterSession;n&&n.draftMode&&n.flow.id===t.flowId&&(this.openResourceCenter(),this.off("resourceCenterChanged",i))};this.on("resourceCenterChanged",i),i()}});return}case"userflow:testTracker":{s(),this.getTargetEnv().postBuilderMessage({kind:"userflow:testTrackerAck",idempotencyKey:t.idempotencyKey}),this.setSessionStorageState(i=>({...i,isTargetTab:!0})),t.testUser?this.identifyTestUser(t.testUser):this.resetTestUser(),this.setSessionStorageState(i=>({...i,activeApp:"trackerTesting",trackerTesting:{trackerName:t.trackerName,token:t.token,events:0}}));return}case"userflow:testTrackerCancel":{this.setSessionStorageState(i=>({...i,activeApp:null,trackerTesting:null}));return}case"userflow:startSmartFlow":{s(),this.getTargetEnv().postBuilderMessage({kind:"userflow:startSmartFlowAck",idempotencyKey:t.idempotencyKey}),this.setSessionStorageState(i=>({...i,isTargetTab:!0,activeApp:"smartFlowRecording",smartFlowRecording:{sessionId:t.sessionId,isRecording:!0,startUrl:t.startUrl||null}}));return}case"userflow:smartFlowCancel":{this.setSessionStorageState(i=>({...i,activeApp:null,smartFlowRecording:null}));return}case"userflow:smartFlowStartOverAck":return;case"userflow:smartFlowComplete":{this.setSessionStorageState(i=>({...i,activeApp:null,smartFlowRecording:null}));return}}},this.onUrlChange=()=>{this.externalId&&(window.clearTimeout(this.flushUrlChangeTimeout),this.flushUrlChangeTimeout=window.setTimeout(()=>this.flushUrlChange(),Xt))},this.onUserActivity=()=>this.ensureConnected(),this.mountSitePage=async(t,r)=>{g.setItem(x,r),u("mounting site page"),this.setResourceCenterLauncherHidden(!0);try{const{SitePage:s}=await _(async()=>{const{SitePage:n}=await import("./SitePage.v1.DgluTuf_.js");return{SitePage:n}},__vite__mapDeps([20,1,2,16,8,7,5,6,4,9,21,17,22,23]));new s(this,t).mount(),u("site page mounted")}catch(s){console.error("Userflow: Failed to mount site page",s)}},this.remountIfNecessary=()=>{!this.ui?.container||document.contains(this.ui.container)||(u("remounting UI because container was missing"),this.remount())},u("constructor, build="+Be),sc(this.onUrlChange),this.setTargetEnv(new nc),this.checkTestUserAtBoot(),this.toggleUI(),this.checkDebuggerSession();for(const t of Jt)document.addEventListener(t,this.remountIfNecessary)}get socketStatus(){return this._socketStatus}destroy(){u("destroy"),this.reset(),Gr(this.onUrlChange),this.destroyTargetEnv();for(const t of Jt)document.removeEventListener(t,this.remountIfNecessary)}setTargetEnv(t){this.destroyTargetEnv(),this.targetEnv=t,t.onBuilderMessage(this.onBuilderMessage)}destroyTargetEnv(){this.targetEnv&&(this.targetEnv.destroy(),this.targetEnv=null)}getTargetEnv(){if(!this.targetEnv)throw new f("Userflow.js: Cannot call getTargetEnv when protocol is not set");return this.targetEnv}setSessionStorageState(t){const r=t(this.getSessionStorageState());g.setItem(Qt,JSON.stringify(r)),this.sessionStorageState=r,this.toggleUI()}getSessionStorageState(){let t=this.sessionStorageState;if(!t){const r=g.getItem(Qt);if(r)try{t=JSON.parse(r)}catch(s){console.error("Userflow.js: Parse ElementSelectionState error:",s)}t||(t={testUser:null,activeApp:null,elementSelection:null,trackerTesting:null}),this.sessionStorageState=t}return t}checkTestUserAtBoot(){const t=this.getSessionStorageState().testUser;t&&(u("checkTestUserAtBoot identifying test user"),this.identifyTestUser(t))}async identifyTestUser(t){this.setSessionStorageState(i=>({...i,testUser:t})),this.reset(),this.init(t.clientToken),this.testUserIdentified=!0,this.externalId=t.id;const r=[this.identify(t.id,{name:t.name,email:t.email,signed_up_at:{set_once:new Date().toISOString(),data_type:"datetime"}},{signature:t.signature})],{group:s}=t;s&&(this.groupId=s.id,r.push(this.group(s.id,{name:s.name},{signature:s.signature}))),await Promise.all(r)}resetTestUser(){this.setSessionStorageState(t=>({...t,testUser:null}))}init(t){if(u("init",t),!t)throw new f("userflow.init() was called but missing Userflow.js Token");if(this.clientToken!==t){if(this.testUserIdentified){u("init() ignoring new token since a test user has been identified");return}this.clientToken&&(u("init() resetting due to new client token"),this.reset()),this.clientToken=t,this.emit("private:initialised")}}ensureInit(){if(!this.clientToken)throw new f("You must call userflow.init() first")}ensureIdentified(){if(this.ensureInit(),!this.externalId)throw new f("You must call userflow.identify() first");return this.externalId}ensureGroup(){if(this.ensureIdentified(),!this.groupId)throw new f("You must call userflow.group() first");return this.groupId}ensureConnected(){if(!this.clientToken||!this.externalId||(this.debounceInactiveDisconnect(),this.socket))return;this._socketStatus="connecting",u("connecting to socket");const t=/^ct_eu\d+_.+$/.test(this.clientToken)?"e.eu.":"e.";let r=S.serverEndpoint||t+"userflow.com";new URL(il).hostname==="js.getuserflow.com"&&r==="e.userflow.com"&&(r="e.getuserflow.com");const s="wss://"+r+"/end-users/"+this.clientToken+"/socket";this.socket=new Xa(s,{reconnectAfterMs:i=>[100,500,1e3,5e3][i-1]||1e4,timeout:20*1e3}),this.socket.connect(),this.socket.onOpen(()=>{u("socket opened")}),this.socket.onClose(()=>{this.emit("private:disconnect")}),this.socket.onError(i=>{console.log("Userflow.js socket error",i),this.reportCspIssue()}),this.channel=this.socket.channel(`end_users:${this.externalId}`,()=>this.makeChannelJoinPayload()),this.channel.join().receive("ok",i=>{typeof this.featureFlags>"u"&&this.clearInitialMessagesQueue(i.featureFlags),this.logrocketAppId=i.logrocketAppId,this.featureFlags=new Set(i.featureFlags),u("channel joined"),this._socketStatus!=="connected"&&(this._socketStatus="connected"),this.featureFlagEnabled("cff_implicit_events")===!0&&!this.implicitTracking&&this.startImplicitTracking(),!this.featureFlagEnabled("cff_implicit_events")&&this.implicitTracking&&(this.implicitTracking.stop(),this.implicitTracking=null)}).receive("error",i=>{["company_closed","invalid_client_token","invalid_user_external_id","incorrect_user_signature","rate_limit_exceeded","user_signature_required"].includes(i.code)?(console.error(`Userflow.js resetting due to: [${i.code}] ${i.message}`),this.reset(),this.clientToken=null):i.code==="invalid_protocol_version"?(console.error(`Userflow.js destroying due to: [${i.code}] ${i.message}`),this.destroy()):console.log("Userflow.js channel join error",i)}),this.channel.on("server_message",i=>this.handleServerMessage(i)),this.channel.on("server_error",i=>{console.log(`Userflow.js server error (${i.code}): ${i.message}`+(i.details&&i.details.length>0?`
Details:
`+i.details.map(n=>(n.path?`${n.path}: `:"")+n.message):""))})}async startImplicitTracking(){await _(()=>import("./implicit-tracking.v1.CfyhJvnx.js"),__vite__mapDeps([24,6])).then(t=>{this.implicitTracking=new t.ImplicitTracking(this),this.implicitTracking.start()}).catch(t=>u(`Implicit tracking failed to load ${t}`))}makeChannelJoinPayload(){let t;g.getItem(x)&&(t=new URL(ue()).searchParams.get("announcement_id")||void 0);const s=this.buildClientContext();this.clientContext=s;const i={protocolVersion:2,userflowClientBuild:Be,signature:this.signature,groupExternalId:this.groupId,groupSignature:this.groupSignature,flowSessionId:this.flowSession?.id||null,checklistSessionId:this.checklistSession?.id||null,bannerSessionId:this.bannerSession?.id||null,resourceCenterSessionId:this.resourceCenterSession?.id||null,siteSessionId:this.siteSession?.id||null,launchers:this.launcherSessions.map(n=>({flowId:n.flow.id})),trackers:Array.from(this.trackers.values()).map(n=>({flowId:n.tracker.flowId})),hasDraftSession:this.hasDraftSession(),clientConditions:Array.from(this.clientConditions.values()).map(n=>({conditionId:n.condition.id,isTrue:n.isTrue})),previewFlowId:g.getItem("previewFlowId"),announcementPreviewId:t,clientContext:s};return u("channel join payload",i),i}disconnect(){window.clearTimeout(this.debounceInactiveDisconnectTimeout),this.socket&&this.socket.disconnect(),this._socketStatus="disconnected",this.socket=null,this.channel=null}debounceInactiveDisconnect(){window.clearTimeout(this.debounceInactiveDisconnectTimeout),this.debounceInactiveDisconnectTimeout=window.setTimeout(()=>{if(this.hasDraftSession()||this.assistantMessageInProgress){this.debounceInactiveDisconnect();return}u("disconnecting from socket due to inactivity"),this.disconnect()},nl)}hasDraftSession(){return!!this.flowSession?.draftMode||!!this.checklistSession?.draftMode||!!this.bannerSession?.draftMode||!!this.resourceCenterSession?.draftMode||this.launcherSessions.some(t=>t.draftMode)}async send(t,{batch:r,endBatch:s,handlesRejection:i}={}){return(!this.inBatch||!["ToggleClientCondition","UpdateClientContext"].includes(t.kind))&&this.checkPushRateLimit(),this.ensureConnected(),r&&!this.inBatch&&(this.inBatch=!0,this.sendRaw({kind:"BeginBatch"})),this.inBatch&&(window.clearTimeout(this.endBatchTimeout),s?this.endBatch():this.endBatchTimeout=window.setTimeout(()=>{this.endBatch()},Xt)),this.sendRaw(t,{handlesRejection:i})}clearInitialMessagesQueue(t){if(this.initialMessagesQueue.length===0)return;const r=t.includes("cff_disable_page_views")===!0,s=t.includes("cff_implicit_events")===!1;for(const i of this.initialMessagesQueue){const{message:n,handlesRejection:o,resolve:a,reject:c}=i;if(s&&n.kind==="TrackRawEvent"){a("skipped due to disabled implicit events");continue}if(r&&(n.kind==="TrackEvent"&&n.name==="page_viewed"||n.kind==="TrackRawEvent"&&n.name==="page_viewed")){a("skipped due to disabled page views tracking");continue}this._sendToChannel(n,a,c,{handlesRejection:o})}this.initialMessagesQueue=[]}async sendRaw(t,{handlesRejection:r}={}){return typeof this.featureFlags>"u"?new Promise((s,i)=>{this.initialMessagesQueue.push({message:t,resolve:s,reject:i,handlesRejection:r})}):new Promise((s,i)=>{this._sendToChannel(t,s,i,{handlesRejection:r})})}_sendToChannel(t,r,s,{handlesRejection:i}={}){if(!this.channel){const c=`Userflow.js: send() should not be called if channel is not set. Message kind=${t.kind}`;if(i)throw Error(c);console.log(c,`
Client message:`,t);return}u(`push ${t.kind} message`,t);const n=this.clientClock,o=()=>{this.serverClock=n,this.channel?.off("phx_error",a)},a=this.channel.on("phx_error",c=>{o();const l=`Userflow.js send ${t.kind} got phx_error`;this._socketStatus==="connected"&&console.log(l,`
Client message:`,t,`
Error:`,c),i&&s(new f(l))});this.channel.push("client_message",t).receive("ok",c=>{o(),r(c)}).receive("error",c=>{o();const l=`Userflow.js error reply (${c.code}): ${c.message}`;console.log(l,`
Client message:`,t,`
Error:`,c),i&&s(new f(l,c.code,c.message))})}endBatch(){this.inBatch=!1,this.sendRaw({kind:"EndBatch"})}checkPushRateLimit(){const t=this.featureFlagEnabled("cff_implicit_events")===!0?200:100,r=Date.now();if(this.pushRateLimitMinuteExpires<r&&(this.pushRateLimitMinute=0,this.pushRateLimitMinuteExpires=r+60*1e3),this.pushRateLimitMinute>=t)throw new f(`This Userflow.js client has reached a maximum of ${t} operations in the last 1 minute. This is usually due to one of the following:

        - Excessive calls to Userflow.js. Check if any of userflow.track(), userflow.identify(), userflow.updateUser() or similar are called repeatedly.
        - The URL changing too frequently. Look into https://userflow.com/docs/userflow-js#seturlfilter and filter out the changing part of the URL.
        - The user legitimately being very active, in which case you can just ignore this error.

        If in doubt, reach out to us at support@userflow.com.`);this.pushRateLimitMinute++}handleServerMessage(t){u(`received ${t.kind} message`,t);const{serverClock:r,flowSession:s,flowSessionClock:i,checklistSession:n,checklistSessionClock:o,bannerSession:a,resourceCenterSession:c}=this;switch(t.kind){case"CheckSessionsAck":this.emit("private:checkSessionsAck");return;case"ServerDebug":return;case"AddLauncher":{const{session:l}=t,h=this.launcherSessions.findIndex(d=>d.flow.id===l.flow.id);h===-1?this.launcherSessions=[...this.launcherSessions,l]:this.launcherSessions=[...this.launcherSessions.slice(0,h),l,...this.launcherSessions.slice(h+1)],this.toggleUI();return}case"AddTracker":{this.addTracker(t.tracker);return}case"AssistantMessageEventWrapper":{this.emit("private:assistantMessageEvent",t);return}case"CancelConditionWaitTimer":window.clearTimeout(this.conditionWaitTimers.get(t.conditionId)),this.conditionWaitTimers.delete(t.conditionId);return;case"ChecklistTaskCompleted":this.unackedTasks.add(t.taskCvid);return;case"ForceGoToStep":if(i>r){u(`ignoring ${t.kind} message due to stale clock flowSessionClock=${i} > serverClock=${r}`);return}s?.id===t.sessionId&&this.emit("gotostep",{session:s,step:{id:t.stepId}});return;case"RemoveLauncher":this.removeLauncher(t.flowId)&&this.toggleUI();return;case"RemoveTracker":{this.removeTracker(t.flowId);return}case"SetBannerSession":this.setBannerSession(t.session),this.toggleUI();return;case"SetChecklistSession":o<=r||n?.id===t.session.id?(this.setChecklistSession(t.session,r),this.toggleUI()):u(`ignoring ${t.kind} message due to stale clock checklistSessionClock=${o} > serverClock=${r}`);return;case"SetFlowSession":i<=r||s?.id===t.session.id?(this.setFlowSession(t.session,r),this.emit("private:setFlowSession",t.session.version.id),this.toggleUI()):u(`ignoring ${t.kind} message due to stale clock flowSessionClock=${i} > serverClock=${r}`);return;case"SetResourceCenterSession":this.setResourceCenterSession(t.session),this.toggleUI();return;case"StartConditionWaitTimer":{if(!this.conditionWaitTimers.has(t.conditionId)){const l=window.setTimeout(()=>{this.conditionWaitTimers.delete(t.conditionId),this.send({kind:"FireConditionWaitTimer",conditionId:t.conditionId},{batch:!0})},parseFloat(t.waitTime)*1e3);this.conditionWaitTimers.set(t.conditionId,l)}return}case"TestStartConditionSuccess":this.emit("private:testStartConditionSuccess");return;case"TrackClientCondition":this.trackClientCondition(t.condition);return;case"UnsetBannerSession":a?.id===t.sessionId&&(this.setBannerSession(null),this.toggleUI());return;case"UnsetChecklistSession":if(o>r){u(`ignoring ${t.kind} message due to stale clock checklistSessionClock=${o} > serverClock=${r}`);return}n?.id===t.sessionId&&(this.setChecklistSession(null,r),this.toggleUI());return;case"UnsetFlowSession":if(i>r){u(`ignoring ${t.kind} message due to stale clock flowSessionClock=${i} > serverClock=${r}`);return}s?.id===t.sessionId&&(this.setFlowSession(null,r),this.toggleUI());return;case"UnsetResourceCenterSession":c?.id===t.sessionId&&(this.setResourceCenterSession(null),this.toggleUI());return;case"UntrackClientCondition":this.untrackClientCondition(t.conditionId);return;case"AddEmbed":{const l=this.embedSessions?.findIndex(h=>h.flow.id===t.session.flow.id);l!==void 0&&l>=0?this.embedSessions=[...this.embedSessions?.slice(0,l)||[],t.session,...this.embedSessions?.slice(l+1)||[]]:this.embedSessions=[...this.embedSessions||[],t.session],this.emit("uistatechange");break}case"RemoveEmbed":{this.embedSessions=(this.embedSessions||[]).filter(l=>l.flow.id!==t.flowId),this.emit("uistatechange");break}case"SetSiteSession":{this.siteSession=t.session,this.emit("private:siteSession",t.session);break}case"UnsetSiteSession":{this.siteSession=null,g.removeItem(x),this.emit("private:unsetSiteSession");break}default:console.warn("Userflow.js: Received unknown message",t);return}}async identify(t,r={},{signature:s}={}){if(u("identify",t),this.ensureInit(),this.testUserIdentified&&t!==this.externalId){u("identify() ignored since a test user has been identified");return}if(typeof t=="number")t=String(t);else if(!t||typeof t!="string")throw new f(`userflow.identify: First argument must be a non-empty string representing the user's ID in your database. Value received: ${JSON.stringify(t)}`);this.externalId&&t!==this.externalId&&(u("identify resetting due to new externalId"),this.reset()),this.externalId=t,this.signature=s||null,this.observeUserActivity(),await Promise.all([this.send({kind:"UpsertUser",attributes:this.normalizeAttributes(r)},{batch:!0}),this.onFirstIdentify()]),this.emit("private:identified")}async identifyAnonymous(t={},r={}){if(!ne.isSupported())throw new f("userflow.identifyAnonymous() is not supported when localStorage access is denied.");const s="anonymousId";let i=ne.getItem(s);i||(i="anon-"+Vt(),ne.setItem(s,i)),await this.identify(i,t,r)}getInitToken(){return this.clientToken}getIdentifiedUser(){return{externalId:this.externalId}}async updateUser(t={},r={}){u("updateUser"),this.ensureIdentified(),await this.send({kind:"UpsertUser",attributes:this.normalizeAttributes(t)},{batch:!0})}async group(t,r={},{signature:s,membership:i}={}){if(u("group",t),this.ensureIdentified(),this.testUserIdentified&&t!==this.groupId){u("group() ignored since a test user has been identified");return}if(typeof t=="number")t=String(t);else if(!t||typeof t!="string")throw new f(`userflow.group: First argument must be a non-empty string representing the group's ID in your database. Value received: ${JSON.stringify(t)}`);this.groupId=t,this.groupSignature=s||null,await this.send({kind:"UpsertGroup",groupExternalId:t,groupSignature:this.groupSignature,groupAttributes:this.normalizeAttributes(r),membershipAttributes:this.normalizeAttributes(i)},{batch:!0})}async updateGroup(t={},r={}){u("updateGroup");const s=this.ensureGroup();await this.send({kind:"UpsertGroup",groupExternalId:s,groupSignature:this.groupSignature,membershipAttributes:this.normalizeAttributes(r.membership),groupAttributes:this.normalizeAttributes(t)},{batch:!0})}normalizeAttributes(t){if(t==null)return{};if(typeof t!="object")throw new f("Userflow: 'attributes' must be an object.");const r={};for(const s in t){if(!t.hasOwnProperty(s))continue;if(s==="traits"){const n=t[s];Object.assign(r,this.extractLegacyTraits(n));continue}let i=t[s];if(typeof i=="string"||typeof i=="number"||typeof i=="boolean"||i==null||Array.isArray(i))r[s]=this.normalizeAttributeLiteralOrList(s,i);else{if(typeof i!="object"||i==null)throw new f(`Userflow: Invalid value for '${s}' attribute.`);if("set"in i)r[s]={set:this.normalizeAttributeLiteralOrList(s,i.set),dataType:this.normalizeDataType(s,i.data_type||i.dataType)};else if("set_once"in i||"setOnce"in i)r[s]={setOnce:this.normalizeAttributeLiteralOrList(s,i.set_once??i.setOnce),dataType:this.normalizeDataType(s,i.data_type||i.dataType)};else if("add"in i){const n=i.add;if(typeof n!="string"&&typeof n!="number")throw new f(`Userflow: Invalid 'add' value for '${s}' attribute. Must be a number or string.`);r[s]={add:n}}else if("subtract"in i){const n=i.subtract;if(typeof n!="string"&&typeof n!="number")throw new f(`Userflow: Invalid 'subtract' value for '${s}' attribute. Must be a number or string.`);r[s]={subtract:n}}else if("append"in i)r[s]={append:this.normalizeAttributeLiteralOrList(s,i.append)};else if("prepend"in i)r[s]={prepend:this.normalizeAttributeLiteralOrList(s,i.prepend)};else if("remove"in i)r[s]={remove:this.normalizeAttributeLiteralOrList(s,i.remove)};else throw new f(`Userflow: Invalid value for '${s}' attribute.`)}}return r}normalizeAttributeLiteralOrList(t,r){return Array.isArray(r)?r.map(s=>this.normalizeAttributeLiteral(t,s)):this.normalizeAttributeLiteral(t,r)}normalizeAttributeLiteral(t,r){if(r==null)return null;if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return r;throw new f(`Userflow: Invalid value for '${t}' attribute.`)}normalizeDataType(t,r){if(!r)return null;switch(r){case"string":return y.STRING;case"number":return y.NUMBER;case"boolean":return y.BOOLEAN;case"datetime":return y.DATETIME}throw new f(`Userflow: Invalid data_type for '${t}' attribute.`)}extractLegacyTraits(t){if(!t)return{};if(!Array.isArray(t)){const r=[];for(const s in t)t.hasOwnProperty(s)&&r.push({name:s,value:t[s]});t=r}return t.reduce((r,{name:s,value:i,dataType:n})=>{if(typeof s!="string"||s.length>100||!s.match(/^[a-z0-9_]+$/))return this.warn("Userflow.identify: Invalid trait name (must be string, no more than 100 characters, and only consist of a-z, 0-9 and underscores). The trait will be ignored. Name was:",s),r;if(typeof i!="string")if(typeof i=="boolean")n||(n="boolean"),i=i?"true":"false";else if(typeof i=="number")n||(n=Number.isInteger(i)?"integer":"decimal"),i=String(i);else return this.warn(`userflow.identify: The value of trait '${s}' is invalid (must be a string, a boolean or a number). The trait will be ignored. Value was:`,i),r;let o=null;if(n)switch(n){case"string":o=y.STRING;break;case"boolean":o=y.BOOLEAN;break;case"integer":o=y.NUMBER;break;case"decimal":o=y.NUMBER;break;case"datetime":o=y.DATETIME;break;default:return this.warn(`userflow.identify: The data type of trait '${s}' is invalid (must be a 'string', 'boolean', 'integer', 'decimal' or 'datetime'). The trait will be ignored. Data type was:`,n),r}return r[s]={set:i,dataType:o},r},{})}async track(t,r={},{userOnly:s}={}){u(`track '${t}'`,r),this.ensureIdentified(),await this.send({kind:"TrackEvent",userOnly:!!s,name:t,attributes:this.normalizeEventAttributes(r)},{batch:!0})}async trackRawEvent(t){const{name:r,attributes:s}=t;u(`track raw event '${r}'`,s),this.ensureIdentified(),await this.send({kind:"TrackRawEvent",name:r,attributes:this.normalizeEventAttributes(s)})}normalizeEventAttributes(t){const r=this.normalizeAttributes(t);for(const s in r){if(!r.hasOwnProperty(s))continue;const i=r[s];if(!(i==null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||Array.isArray(i)||"set"in i))throw new f(`Userflow: Invalid value for '${s}' attribute. Event attributes only support literal values, list values and 'set' changes.`)}return r}onFirstIdentify(){this.onFirstIdentifyRun||(this.onFirstIdentifyRun=!0,this.onFirstIdentifyTimeout=window.setTimeout(()=>{this.trackPageViewed(),this.firstIdentifyCallback?(this.firstIdentifyCallback(),this.firstIdentifyCallback=null):this.checkUrlForStartFlow()},0))}onceIdentified(t){this.isIdentified()?t():this.firstIdentifyCallback=t}checkUrlForStartFlow(){const t=new URL(ue()),r=t.searchParams.get("userflow")||t.searchParams.get("studio1_flow")||t.searchParams.get("studio1_walkthrough");r&&(u(`url contained flow ${r}`),this.startFlow({flowId:r,startReason:Se.LINK,batch:!0}),t.searchParams.delete("userflow"),t.searchParams.delete("studio1_flow"),t.searchParams.delete("studio1_walkthrough"),window.history.replaceState({},"",t.toString()),this.clientContext=this.buildClientContext(),this.pushUpdateClientContext())}flushUrlChange(){const t=this.buildClientContext();(!this.clientContext||t.pageUrl!==this.clientContext.pageUrl)&&(this.clientContext=t,this.pushUpdateClientContext(),this.trackPageViewed(),this.checkUrlForStartFlow())}async trackPageViewed(){this.featureFlags&&this.featureFlagEnabled("cff_disable_page_views")===!0||(this.pageTrackingDisabled||this.track("page_viewed",{}),this.trackRawPageViewed())}async trackRawPageViewed(){this.featureFlags&&(this.featureFlagEnabled("cff_implicit_events")===!1||this.featureFlagEnabled("cff_disable_page_views")===!0)||this.trackRawEvent({name:"page_viewed",attributes:{id:Vt(),page_title:document.title,...this.buildClientContext()}})}buildClientContext(){let t=null;const r=g.getItem(x);if(r){const i=new URL(ue()).pathname.match(/^\/([^/]+)\/?(?:\/([^/]+)\/?)?$/);i&&(t=i[1])}return{pageUrl:el(),viewportWidth:window.innerWidth,viewportHeight:window.innerHeight,...r&&{siteId:r},...t&&{localeCode:t}}}pushUpdateClientContext(){this.send({kind:"UpdateClientContext",clientContext:this.clientContext},{batch:!0})}ackCompletedTask(t){this.unackedTasks.delete(t)}taskIsUnacked(t){return this.unackedTasks.has(t)}isIdentified(){return this.externalId!=null}on(t,r){let s=this.listeners.get(t);s||(s=new Set,this.listeners.set(t,s)),s.add(r)}off(t,r){const s=this.listeners.get(t);s&&s.delete(r)}emit(t,...r){const s=this.listeners.get(t);s&&Array.from(s).forEach(n=>n(...r))}observeUserActivity(){document.addEventListener("mouseover",this.onUserActivity),document.addEventListener("pointerdown",this.onUserActivity),document.addEventListener("keydown",this.onUserActivity)}unobserveUserActivity(){document.removeEventListener("mouseover",this.onUserActivity),document.removeEventListener("pointerdown",this.onUserActivity),document.removeEventListener("keydown",this.onUserActivity)}reset(){u("reset"),this.externalId=null,this.groupId=null,this.sessionStorageState=null,this.setFlowSession(null,0),this.setChecklistSession(null,0),this.setBannerSession(null),this.setResourceCenterSession(null),this.resourceCenterLauncherHidden=null,this.launcherSessions=[],this.activeLauncherFlowId=null,this.notifications=[],this.unackedTasks=new Set,this.onFirstIdentifyRun=!1,window.clearTimeout(this.onFirstIdentifyTimeout),this.onFirstIdentifyTimeout=void 0,this.clientContext=null,this.unobserveUserActivity(),window.clearTimeout(this.flushUrlChangeTimeout),this.flushUrlChangeTimeout=void 0,this.clientConditions.forEach((t,r)=>{this.untrackClientCondition(r)}),this.firstIdentifyCallback=null,this.testUserIdentified=!1,ne.removeItem("anonymousId"),this.unmountUI(),this.disconnect(),this.inBatch=!1,window.clearTimeout(this.endBatchTimeout),this.endBatchTimeout=void 0,this.clientClock=1,this.serverClock=1,this.titleMonitored=void 0,this.titleObserver&&(this.titleObserver.disconnect(),this.titleObserver=void 0)}async startFlow({flowId:t,stepCvid:r,startReason:s,once:i,batch:n,replaceCurrent:o}){if(this.ensureIdentified(),o&&this.flowSession&&this.endFlow(this.flowSession,{endReason:he.REPLACED,batch:!0}),u(`startFlow ${t}`,{startReason:s}),this.checklistSession?.flow.id===t){u("startFlow matches current checklist, so showing it instead"),this.showChecklist();return}const a={kind:"StartFlow",flowId:t,stepCvid:r,startReason:s,once:!!i};await this.send(a,{batch:n})}async trackButtonEvent(t,r,s,i){const n={kind:"TrackButtonEvent",eventName:t,stepCvid:s,sessionId:i,token:r};await this.send(n,{batch:!0})}async startFlowWithToken(t){this.ensureIdentified(),u("startFlowWithToken",{token:t}),await this.send({kind:"StartFlowWithToken",token:t},{batch:!0})}optimisticClockUIUpdate(t){this.clientClock++,t(),this.toggleUI()}async showChecklist(){if(this.resourceCenterEmbedsChecklist()&&!this.embedChecklistSessions()){this.openResourceCenter();return}this.embedChecklistSessions()||(this.unmarkExpandPending(),!(!this.checklistSession||this.checklistExpanded)&&(this.ensureIdentified(),this.checklistExpanded=!0,this.toggleUI(),g.setItem(`checklistExpanded:${this.checklistSession.id}`,"1"),await this.send({kind:"ShowChecklist",sessionId:this.checklistSession.id},{batch:!0})))}async hideChecklist(){if(this.resourceCenterEmbedsChecklist()){this.closeResourceCenter();return}!this.checklistSession||!this.checklistExpanded||(this.ensureIdentified(),this.checklistExpanded=!1,this.toggleUI(),g.removeItem(`checklistExpanded:${this.checklistSession.id}`),await this.send({kind:"HideChecklist",sessionId:this.checklistSession.id},{batch:!0}))}async unmarkExpandPending(){!this.checklistSession||!this.checklistExpandPending||(this.checklistExpandPending=!1,await this.send({kind:"UnmarkExpandPending",sessionId:this.checklistSession.id},{batch:!0}))}async openResourceCenter(){this.resourceCenterEmbedsChecklist()&&this.unmarkExpandPending(),!(!this.resourceCenterSession||this.resourceCenterOpen)&&(this.ensureIdentified(),this.resourceCenterOpen=!0,this.toggleUI(),this.emit("resourceCenterChanged"),g.setItem(`resourceCenterOpen:${this.resourceCenterSession.id}`,"1"),await this.send({kind:"OpenResourceCenter",sessionId:this.resourceCenterSession.id},{batch:!0}))}async closeResourceCenter(){!this.resourceCenterSession||!this.resourceCenterOpen||(this.ensureIdentified(),this.resourceCenterOpen=!1,this.toggleUI(),this.emit("resourceCenterChanged"),g.removeItem(`resourceCenterOpen:${this.resourceCenterSession.id}`),await this.send({kind:"CloseResourceCenter",sessionId:this.resourceCenterSession.id},{batch:!0}))}toggleResourceCenter(){this.resourceCenterOpen?this.closeResourceCenter():this.openResourceCenter()}setResourceCenterLauncherHidden(t){this.resourceCenterLauncherHidden=t,this.toggleUI()}getResourceCenterState(){if(!this.resourceCenterSession)return null;const t=this.resourceCenterEmbedsChecklist(),{checklistSession:r}=this,s=this.resourceCenterSession.version.resourceCenter?.blocks.find(i=>i.type===Je.ANNOUNCEMENTS);return{isOpen:this.resourceCenterOpen,hasChecklist:t,uncompletedChecklistTaskCount:t&&r?rl(r):0,unreadAnnouncementCount:s?.unreadAnnouncementCount||0}}resourceCenterEmbedsChecklist(){const t=this.resourceCenterSession;return!!t&&!!t.version.resourceCenter?.blocks.some(r=>r.type===Je.CHECKLIST)}embedChecklistSessions(){return this.embedSessions.some(t=>!!t.version.embed?.blocks?.some(r=>r.type===Kr.CHECKLIST))}async endFlow(t,{endReason:r,batch:s}){this.ensureIdentified(),this.optimisticClockUIUpdate(()=>{const{clientClock:a}=this;this.flowSession?.id===t.id&&this.setFlowSession(null,a),this.checklistSession?.id===t.id&&this.setChecklistSession(null,a),this.bannerSession?.id===t.id&&this.setBannerSession(null),this.resourceCenterSession?.id===t.id&&this.setResourceCenterSession(null)});const{flow:i}=t,n={id:i.id,type:i.type.toLowerCase()};i.type===de.CHECKLIST?this.emit("checklistEnded",{checklist:n,endReason:r}):i.type===de.FLOW&&this.emit("flowEnded",{flow:n,endReason:r});const o={kind:"EndFlow",sessionId:t.id,endReason:r};await this.send(o,{batch:s})}async goToStep(t,r){u("goToStep",t.id,r.name||r.id),this.ensureIdentified();const s=this.send({kind:"GoToStep",sessionId:t.id,stepId:r.id});t.currentStep=r,this.emit("gotostep",{session:t,step:r}),await s}async endAllFlows(){u("endAllFlows"),this.optimisticClockUIUpdate(()=>{const{clientClock:t}=this;this.setFlowSession(null,t),this.setChecklistSession(null,t)}),await this.send({kind:"EndAllFlows"})}async endChecklist(){u("endChecklist");const t=this.checklistSession||this.flowSession;t?.flow.type===de.CHECKLIST&&this.endFlow(t,{endReason:he.USERFLOWJS})}setFlowSession(t,r=this.clientClock){const s=this.flowSession;this.flowSession=t,this.flowSessionClock=r,t&&!s&&(this.hideChecklist(),this.closeResourceCenter()),t==null&&this.originalActiveElement&&(typeof this.originalActiveElement.focus=="function"&&this.originalActiveElement.focus(),this.originalActiveElement=void 0)}setChecklistSession(t,r=this.clientClock){const s=this.checklistSession;this.checklistSession=t,this.checklistSessionClock=r,t===null&&(this.checklistExpanded=!1,this.checklistExpandPending=!1),t&&t.id!==s?.id&&(this.checklistExpanded=!!g.getItem(`checklistExpanded:${t.id}`),t.expandPending&&(this.checklistExpandPending=!0)),this.emit("checklistChanged"),this.emit("resourceCenterChanged")}setBannerSession(t){this.bannerSession=t}setResourceCenterSession(t){const r=this.resourceCenterSession;t=typeof t=="function"?t(this.resourceCenterSession):t,this.resourceCenterSession=t,t===null&&(this.resourceCenterOpen=!1),r&&r.id!==t?.id&&g.removeItem(`resourceCenterOpen:${r.id}`),t&&t.id!==r?.id&&(this.resourceCenterOpen=!!g.getItem(`resourceCenterOpen:${t.id}`)),this.emit("resourceCenterChanged")}launcherSeen(t){this.send({kind:"StartFlow",flowId:t,startReason:Se.LAUNCHER_SEEN,once:!1})}activateLauncher(t){const r=this.activeLauncherFlowId&&this.launcherSessions.find(s=>s.flow.id===this.activeLauncherFlowId);r&&this.deactivateLauncher(r),this.activeLauncherFlowId=t.flow.id,this.toggleUI(),this.send({kind:"ActivateLauncher",flowId:t.flow.id})}deactivateLauncher(t){const{launcher:r}=t.version;t.flow.id===this.activeLauncherFlowId&&(r?.dismissOn===Fr.DEACTIVATE?this.dismissLauncher(t,{endReason:he.LAUNCHER_DEACTIVATED}):(this.activeLauncherFlowId=null,this.toggleUI()))}dismissLauncher(t,{endReason:r}){const s=t.flow.id;this.removeLauncher(s),this.toggleUI(),this.send({kind:"DismissLauncher",flowId:s,endReason:r})}removeLauncher(t){const r=this.launcherSessions.findIndex(s=>s.flow.id===t);return r===-1?!1:(this.launcherSessions=[...this.launcherSessions.slice(0,r),...this.launcherSessions.slice(r+1)],t===this.activeLauncherFlowId&&(this.activeLauncherFlowId=null),!0)}async toggleUI(){const t=this.getSessionStorageState();!this.flowSession&&(this.checklistExpandPending||this.checklistSession?.version.checklist?.tasks.some(r=>this.taskIsUnacked(r.cvid)))&&this.showChecklist(),t.isTargetTab&&this.monitorTitle(),this.emit("uistatechange"),this.shouldBeMounted()?await this.mountUI():this.unmountUI()}shouldBeMounted(){return this.uiDisabled||this.siteSession?.id||g.getItem(x)?!1:!!this.getSessionStorageState().activeApp||!!this.flowSession||!!this.checklistSession&&(this.checklistExpanded||!!this.checklistSession?.version.checklist?.launcherEnabled)||!!this.bannerSession||!!this.resourceCenterSession||this.launcherSessions.length>0||this.notifications.length>0}async mountUI(){if(!this.ui){const t=await this.createUI();this.shouldBeMounted()&&!this.ui&&(u("mount UI"),this.ui=t,this.ui.mount())}}unmountUI(){this.ui&&(u("unmount UI"),this.ui.unmount(),this.ui=null)}checkDebuggerSession(){if(this.debuggerUI)return;const t=this.sessionStorageState?.debuggerApp;t&&t?.x&&t?.y&&this.mountDebugger()}async mountDebugger(){if(!this.debuggerMountInProgress){if(this.debuggerUI){this.debuggerUI.unmount();return}this.debuggerMountInProgress=!0;try{const{DebuggerUI:t}=await _(async()=>{const{DebuggerUI:r}=await import("./DebuggerUI.v1.cbZqZZGf.js");return{DebuggerUI:r}},__vite__mapDeps([25,1,2,11,7,5,6,8,13,23,21,9,22,17]));this.debuggerUI=new t(this,Be),this.debuggerUI.mount()}catch(t){console.error("Userflow: Failed to mount debugger UI",t)}finally{this.debuggerMountInProgress=!1}}}unMountDebugger(){this.debuggerUI=null}remount(){this.unmountUI(),this.toggleUI()}async createUI(){try{const t=_(()=>import("./ui.v1.BixPdj8k.js"),__vite__mapDeps([26,1,2]));this.bannerSession&&sl(),this.resourceCenterSession&&tl();const{RealUI:r}=await t;return new r(this)}catch(t){throw this.reportCspIssue(),t}}async trackClientCondition(t){if(this.clientConditions.has(t.id))return;u("track client condition",t),this.clientConditions.set(t.id,{condition:t,isTrue:null});const{conditionTypes:r}=await _(async()=>{const{conditionTypes:n}=await import("./flow-condition-types.v1.DSgTaawO.js").then(o=>o.j);return{conditionTypes:n}},__vite__mapDeps([5,2,6])),s=r[t.type],i=this.clientConditions.get(t.id);i&&(i.untrack=s.track({sessionData:new Yt([]),condition:t,callback:n=>{i.isTrue!==n&&(u("client condition truthiness changed",n,i.condition),i.isTrue=n,this.send({kind:"ToggleClientCondition",conditionId:t.id,isTrue:n},{batch:!0}))}}))}untrackClientCondition(t){const r=this.clientConditions.get(t);r&&(u("untrack client condition",r.condition),r.untrack&&r.untrack(),this.clientConditions.delete(t))}async addTracker(t){let r=this.trackers.get(t.flowId);r?r.tracker=t:this.trackers.set(t.flowId,{tracker:t,isTrue:!1});const{conditionTypes:s}=await _(async()=>{const{conditionTypes:c}=await import("./flow-condition-types.v1.DSgTaawO.js").then(l=>l.j);return{conditionTypes:c}},__vite__mapDeps([5,2,6])),i=this.trackers.get(t.flowId);if(!i)return;const{tracker:n}=i,{condition:o}=n,a=s[o.type];i.untrack&&i.untrack(),i.untrack=a.track({sessionData:new Yt(n.data),condition:o,flipBackEvents:!0,callback:c=>{const l=i.isTrue;i.isTrue=c,!l&&c&&this.send({kind:"TrackTrackerEvent",token:n.token},{batch:!0})},description:`event tracker ${n.flowId}`}),this.emit("private:trackerStarted")}removeTracker(t){const r=this.trackers.get(t);r&&(r.untrack&&r.untrack(),this.trackers.delete(t),this.emit("private:trackerStopped"))}monitorTitle(){if(this.titleMonitored)return;this.titleMonitored=!0,this.fixTitle();const t=document.querySelector("title");if(t){const r=new MutationObserver(()=>{this.fixTitle()});r.observe(t,{childList:!0}),this.titleObserver=r}}fixTitle(){const t=document.title,s="[Userflow Preview] "+t.replace(/\[Userflow Preview\]\s*/g,"");t!==s&&(document.title=s)}reportCspIssue(){const t=this.getSessionStorageState();(this.testUserIdentified||t.activeApp)&&!this.cspIssueReported&&(this.cspIssueReported=!0,u("csp issue detected"),Ye({kind:"userflow:crxCspIssueDetected"}))}getAudio(){return this.audio||(this.audio=new Audio),this.audio}playAudio(t){if(document.hidden)return;const r=this.getAudio();t&&(r.src=t);const s=r.play();this.audioReady=!0,s&&s.catch(i=>{i.name})}pauseAudio(){const t=this.audio;t&&!t.paused&&t.pause()}async getStepSpeech(t,r){return(await this.send({kind:"GetStepSpeechV2",syntheticVoice:t,text:r})).url}featureFlagEnabled(t){return this.featureFlags?this.featureFlags.has(t):!1}showNotification(t,r,s){const n={id:++this.notificationIdCounter,label:t,message:r,type:s};this.notifications=[...this.notifications,n],this.toggleUI()}dismissNotification(t){this.notifications=this.notifications.filter(r=>r.id!==t),this.toggleUI()}warn(...t){console.warn(...t)}nextRef(){return this.refCounter++}}if(typeof window.userflow>"u"||window.userflow._stubbed){const e=Object.assign(window.userflow||{},al());window.userflow=e,window.studio1=e,cl()}function al(){const e=new ol;return{_stubbed:!1,init(t){e.init(t)},identify(t,r={},s={}){return e.identify(t,r,s)},identifyAnonymous(t={},r={}){return e.identifyAnonymous(t,r)},isIdentified(){return e.isIdentified()},updateUser(t,r={}){return e.updateUser(t,r)},group(t,r={},s={}){return e.group(t,r,s)},updateGroup(t,r={}){return e.updateGroup(t,r)},track(t,r={},s={}){return e.track(t,r,s)},start(t,{once:r}={}){return e.startFlow({flowId:t,startReason:Se.USERFLOWJS,once:r})},startFlow(t){return console.warn("Userflow.js: userflow.startFlow() has been deprecated. Use userflow.start() instead."),window.userflow.start(t)},startWalk(t){return console.warn("Userflow.js: userflow.startWalk() has been deprecated. Use userflow.start() instead."),window.userflow.start(t)},endAll(){return e.endAllFlows()},endChecklist(){return e.endChecklist()},endAllFlows(){"Userflow.js: userflow.endAllFlows() has been deprecated. Use userflow.endAll() instead.";return window.userflow.endAll()},async endFlow(){console.warn("Userflow.js: userflow.endFlow() has been deprecated and no longer has any effect.")},async endWalk(){console.warn("Userflow.js: userflow.endWalk() has been deprecated and no longer has any effect.")},openResourceCenter(){e.openResourceCenter()},closeResourceCenter(){e.closeResourceCenter()},toggleResourceCenter(){e.toggleResourceCenter()},setResourceCenterLauncherHidden(t){e.setResourceCenterLauncherHidden(t)},getResourceCenterState(){return e.getResourceCenterState()},setWalkPosition(){console.warn("Userflow.js: userflow.setWalkPosition() has been deprecated and no longer has any effect.")},reset(){e.reset()},remount(){e.remount()},on(t,r){e.on(t,r)},off(t,r){e.off(t,r)},setCustomInputSelector(t){console.warn("Userflow.js: userflow.setCustomInputSelector() has been deprecated. Use userflow.registerCustomInput() instead. See docs: https://userflow.com/docs/userflow-js"),t&&S.customInputs.push({cssSelector:t})},registerCustomInput(t,r){S.customInputs.push({cssSelector:t,getValue:r})},setCustomNavigate(t){S.customNavigate=t},setUrlFilter(t){S.urlFilter=t},setLinkUrlDecorator(t){S.linkUrlDecorator=t,e.emit("uistatechange")},setInferenceAttributeNames(t){S.inferenceAttributeNames=t},setInferenceAttributeFilter(t,r){S.inferenceAttributeFilters[t]=zt(r)},setInferenceClassNameFilter(t){S.inferenceClassNameFilters=zt(t)},setScrollPadding(t){S.scrollPadding=t},setCustomScrollIntoView(t){S.customScrollIntoView=t},prepareAudio(){e.playAudio(null)},setShadowDomEnabled(t){console.warn("Userflow.js: userflow.setShadowDomEnabled() has been deprecated. Please remove this call from your Userflow.js snippet. Shadow DOM is supported by default now.")},setPageTrackingDisabled(t){e.pageTrackingDisabled=t},setBaseZIndex(t){S.baseZIndex=t},setServerEndpoint(t){S.serverEndpoint=t},disableEvalJs(){S.evalJsDisabled=!0},_setTargetEnv(t){e.setTargetEnv(t)},debugger(){return e.mountDebugger()},mountSitePage(t,r){return e.mountSitePage(t,r)}}}function cl(){const e=window.userflow,t=window.USERFLOWJS_QUEUE;if(delete window.USERFLOWJS_QUEUE,!(!t||t.length===0)){u(`processing ${t.length} items in the queue`);for(const[r,s,i]of t){if(typeof e[r]!="function"){console.error(`Userflow.js: Invalid method '${r}' in queue`);continue}const n=e[r](...i);s&&n&&typeof n.then=="function"&&n.then(s.resolve,s.reject)}u("queue processed")}}export{Kc as $,y as A,sl as B,rl as C,zc as D,he as E,lc as F,Je as G,g as H,Dc as I,S as J,jc as K,Rc as L,Ic as M,bc as N,Uc as O,Cc as P,Pc as Q,tl as R,fc as S,Oc as T,f as U,kc as V,Xc as W,Se as X,Zc as Y,Mc as Z,_,de as a,xc as a0,Hc as a1,Vc as a2,Gc as a3,Fc as a4,Nc as a5,Tc as a6,ul as a7,ue as a8,Lc as a9,Ac as aa,mc as ab,el as ac,sc as ad,Gr as ae,dc as af,hl as ag,Jt as ah,Yc as ai,Qc as aj,ac as ak,vc as b,Ec as c,u as d,oc as e,X as f,ll as g,hc as h,Jc as i,cc as j,gc as k,Yt as l,Bc as m,Wc as n,uc as o,Hr as p,rc as q,ne as r,yc as s,_c as t,Ye as u,Vt as v,wc as w,$c as x,Sc as y,pc as z};
//# sourceMappingURL=userflow.js.map
